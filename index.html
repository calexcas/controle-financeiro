<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Controle Financeiro Familiar</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=FuykDwv-3jxIKsvEKfv_2kGzcc8cx6kkseqlM4aVB97q5qMuFoAk2EO2hFgDvrN3tfg7sJM26YjE_cdn3s_wTKjJXDTcLyqzI5ekR8ba6L3hpaX2ej7Q35CPSSOmDwBGNaaieB26gmNW7ZeWjo5GdNAVpPs-BUtqQdr47yH6Gi0BVo-Cq94CgUuNCD7rMorJAkF4RSmnukkKmWxiKm5h5aCiazRgaSwTousD2mEpKUzOmE4ImIOqduW1xKa01HLihSBVT3sSY_qIlVcpJDSMwbY0u1BM1FoDOAA0k8pnfYbTA3769Qq86priH63Vh7SSFi1lfXpUG39Cx9CFA89Qa3q-2Ssp0nlDhS5MSFDt5pVgiU1VsVkAxQKGz0VDyQS4iVVUZoMghCcBGexCMWTusj1HIxgo9_AH9RwI2i9pRkjbCexwR2thskV_cV_8NNhi" charset="UTF-8"></script><script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .gradient-purple { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .gradient-blue { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .gradient-orange { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
        .gradient-green { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
        .chart-container { height: 400px; }
    </style>
</head>
<body class="bg-gray-100">
    <!-- Header -->
    <header class="bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6 shadow-lg">
        <div class="container mx-auto">
            <h1 class="text-3xl font-bold flex items-center">
                <i class="fas fa-chart-line mr-3"></i>
                Sistema de Controle Financeiro Familiar
            </h1>
            <p class="text-purple-100 mt-2">Gerencie suas finanças de forma inteligente e visual</p>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white shadow-md">
        <div class="container mx-auto px-6">
            <div class="flex space-x-8">
                <button class="nav-btn active py-4 px-6 text-blue-600 border-b-2 border-blue-600 font-semibold" data-tab="dashboard">
                    <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                </button>
                <button class="nav-btn py-4 px-6 text-gray-600 hover:text-blue-600 font-semibold" data-tab="gastos">
                    <i class="fas fa-shopping-cart mr-2"></i>Gastos
                </button>
                <button class="nav-btn py-4 px-6 text-gray-600 hover:text-blue-600 font-semibold" data-tab="gastos-fixos">
                    <i class="fas fa-home mr-2"></i>Gastos Fixos
                </button>
                <button class="nav-btn py-4 px-6 text-gray-600 hover:text-blue-600 font-semibold" data-tab="rendas">
                    <i class="fas fa-dollar-sign mr-2"></i>Rendas
                </button>
                <button class="nav-btn py-4 px-6 text-gray-600 hover:text-blue-600 font-semibold" data-tab="poupanca">
                    <i class="fas fa-piggy-bank mr-2"></i>Poupança
                </button>
                <button class="nav-btn py-4 px-6 text-gray-600 hover:text-blue-600 font-semibold" data-tab="metas">
                    <i class="fas fa-target mr-2"></i>Metas
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-8">
        <!-- Dashboard Tab -->
        <div id="dashboard" class="tab-content">
            <!-- Filters -->
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-xl font-semibold mb-4">Filtros</h2>
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Ano</label>
                        <select id="filter-year" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <!-- Anos serão gerados automaticamente -->
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Mês</label>
                        <select id="filter-month" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <option value="">Todos</option>
                            <option value="01">Janeiro</option>
                            <option value="02">Fevereiro</option>
                            <option value="03">Março</option>
                            <option value="04">Abril</option>
                            <option value="05">Maio</option>
                            <option value="06">Junho</option>
                            <option value="07">Julho</option>
                            <option value="08">Agosto</option>
                            <option value="09">Setembro</option>
                            <option value="10">Outubro</option>
                            <option value="11">Novembro</option>
                            <option value="12">Dezembro</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Categoria</label>
                        <select id="filter-category" class="w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <option value="">Todas</option>
                            <option value="Alimentação">Alimentação</option>
                            <option value="Transporte">Transporte</option>
                            <option value="Moradia">Moradia</option>
                            <option value="Lazer">Lazer</option>
                            <option value="Saúde">Saúde</option>
                            <option value="Educação">Educação</option>
                            <option value="Outros">Outros</option>
                        </select>
                    </div>
                    <div class="flex items-end">
                        <button id="apply-filters" class="w-full bg-gray-600 text-white py-2 px-4 rounded-md hover:bg-gray-700 transition-colors">
                            <i class="fas fa-filter mr-2"></i>Aplicar Filtros
                        </button>
                    </div>
                </div>
            </div>

            <!-- Summary Cards -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                <div class="gradient-purple rounded-lg p-6 text-white">
                    <h3 class="text-lg font-semibold mb-2">Renda Total</h3>
                    <p class="text-3xl font-bold" id="total-renda">R$ 0,00</p>
                    <i class="fas fa-arrow-up text-green-300 text-2xl float-right"></i>
                </div>
                <div class="gradient-blue rounded-lg p-6 text-white">
                    <h3 class="text-lg font-semibold mb-2">Total Poupado</h3>
                    <p class="text-3xl font-bold" id="total-poupado">R$ 0,00</p>
                    <i class="fas fa-piggy-bank text-blue-300 text-2xl float-right"></i>
                </div>
                <div class="gradient-orange rounded-lg p-6 text-white">
                    <h3 class="text-lg font-semibold mb-2">Total Gastos</h3>
                    <p class="text-3xl font-bold" id="total-gastos">R$ 0,00</p>
                    <i class="fas fa-shopping-cart text-red-300 text-2xl float-right"></i>
                </div>
                <div class="gradient-green rounded-lg p-6 text-white">
                    <h3 class="text-lg font-semibold mb-2">Saldo Atual</h3>
                    <p class="text-3xl font-bold" id="saldo-atual">R$ 0,00</p>
                    <i class="fas fa-wallet text-green-300 text-2xl float-right"></i>
                </div>
            </div>

            <!-- Charts -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold mb-4">Gastos por Categoria</h3>
                    <div class="chart-container">
                        <canvas id="category-chart"></canvas>
                    </div>
                </div>
                <div class="bg-white rounded-lg shadow-md p-6">
                    <h3 class="text-lg font-semibold mb-4">Evolução da Poupança</h3>
                    <div class="chart-container">
                        <canvas id="savings-chart"></canvas>
                    </div>
                </div>
            </div>

            <div class="bg-white rounded-lg shadow-md p-6">
                <h3 class="text-lg font-semibold mb-4">Gastos Fixos vs Variáveis</h3>
                <div class="chart-container">
                    <canvas id="expenses-chart"></canvas>
                </div>
            </div>
        </div>

        <!-- Gastos Tab -->
        <div id="gastos" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4">Controle de Gastos</h2>
                
                <!-- Add Expense Form -->
                <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                    <h3 class="text-lg font-semibold mb-4">Adicionar Gasto</h3>
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                        <input type="date" id="gasto-data" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <input type="text" id="gasto-descricao" placeholder="Descrição" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <select id="gasto-categoria" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <option value="">Selecione</option>
                            <option value="Alimentação">Alimentação</option>
                            <option value="Transporte">Transporte</option>
                            <option value="Moradia">Moradia</option>
                            <option value="Lazer">Lazer</option>
                            <option value="Saúde">Saúde</option>
                            <option value="Educação">Educação</option>
                            <option value="Outros">Outros</option>
                        </select>
                        <input type="number" id="gasto-valor" placeholder="Valor" step="0.01" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <select id="gasto-forma" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <option value="">Forma de Pagamento</option>
                            <option value="Dinheiro">Dinheiro</option>
                            <option value="Cartão de Crédito">Cartão de Crédito</option>
                            <option value="Cartão de Débito">Cartão de Débito</option>
                            <option value="Transferência">Transferência</option>
                            <option value="Boleto">Boleto</option>
                        </select>
                    </div>
                    <button id="add-gasto" class="mt-4 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>Adicionar Gasto
                    </button>
                </div>

                <!-- Expenses List -->
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descrição</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categoria</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Forma de Pagamento</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody id="gastos-list" class="bg-white divide-y divide-gray-200">
                            <!-- Expenses will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Rendas Tab -->
        <div id="rendas" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4">Controle de Rendas</h2>
                
                <!-- Add Income Form -->
                <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                    <h3 class="text-lg font-semibold mb-4">Adicionar Renda</h3>
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                        <select id="renda-mes" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <option value="">Mês</option>
                            <option value="01">Janeiro</option>
                            <option value="02">Fevereiro</option>
                            <option value="03">Março</option>
                            <option value="04">Abril</option>
                            <option value="05">Maio</option>
                            <option value="06">Junho</option>
                            <option value="07">Julho</option>
                            <option value="08">Agosto</option>
                            <option value="09">Setembro</option>
                            <option value="10">Outubro</option>
                            <option value="11">Novembro</option>
                            <option value="12">Dezembro</option>
                        </select>
                        <select id="renda-ano" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <!-- Anos serão gerados automaticamente -->
                        </select>
                        <select id="renda-tipo" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <option value="">Tipo de Renda</option>
                            <option value="Salário Titular">Salário Titular</option>
                            <option value="Salário Cônjuge">Salário Cônjuge</option>
                            <option value="Freelance">Freelance</option>
                            <option value="Investimentos">Investimentos</option>
                            <option value="Bonificação">Bonificação</option>
                            <option value="Outros">Outros</option>
                        </select>
                        <input type="number" id="renda-valor" placeholder="Valor" step="0.01" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <input type="text" id="renda-descricao" placeholder="Descrição" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button id="add-renda" class="mt-4 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>Adicionar Renda
                    </button>
                </div>

                <!-- Income List -->
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Mês/Ano</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tipo</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descrição</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody id="rendas-list" class="bg-white divide-y divide-gray-200">
                            <!-- Income will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Poupança Tab -->
        <div id="poupanca" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4">Controle de Poupança</h2>
                
                <!-- Add Savings Form -->
                <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                    <h3 class="text-lg font-semibold mb-4">Adicionar Movimentação</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <input type="date" id="poupanca-data" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <select id="poupanca-tipo" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                            <option value="">Tipo</option>
                            <option value="Depósito">Depósito</option>
                            <option value="Retirada">Retirada</option>
                        </select>
                        <input type="number" id="poupanca-valor" placeholder="Valor" step="0.01" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <input type="text" id="poupanca-descricao" placeholder="Descrição" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button id="add-poupanca" class="mt-4 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>Adicionar Movimentação
                    </button>
                </div>

                <!-- Savings List -->
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tipo</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Saldo</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descrição</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody id="poupanca-list" class="bg-white divide-y divide-gray-200">
                            <!-- Savings will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Metas Tab -->
        <div id="metas" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4">Controle de Metas</h2>
                
                <!-- Add Goal Form -->
                <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                    <h3 class="text-lg font-semibold mb-4">Adicionar Meta</h3>
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                        <input type="text" id="meta-nome" placeholder="Nome da Meta" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <input type="number" id="meta-valor-alvo" placeholder="Valor Alvo" step="0.01" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <input type="number" id="meta-valor-atual" placeholder="Valor Atual" step="0.01" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <input type="date" id="meta-data-limite" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button id="add-meta" class="mt-4 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>Adicionar Meta
                    </button>
                </div>

                <!-- Goals List -->
                <div class="space-y-4" id="metas-list">
                    <!-- Goals will be populated here -->
                </div>
            </div>
        </div>

        <!-- Gastos Fixos Tab -->
        <div id="gastos-fixos" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold mb-4">Controle de Gastos Fixos</h2>
                
                <!-- Add Fixed Expense Form -->
                <div class="mb-6 p-4 bg-gray-50 rounded-lg">
                    <h3 class="text-lg font-semibold mb-4">Adicionar Gasto Fixo</h3>
                    <div class="grid grid-cols-1 md:grid-cols-5 gap-4">
                        <input type="text" id="gasto-fixo-item" placeholder="Item" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <input type="number" id="gasto-fixo-valor" placeholder="Valor Mensal" step="0.01" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <input type="date" id="gasto-fixo-inicio" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <input type="date" id="gasto-fixo-fim" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                        <input type="text" id="gasto-fixo-obs" placeholder="Observações" class="p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500">
                    </div>
                    <button id="add-gasto-fixo" class="mt-4 bg-green-600 text-white py-2 px-4 rounded-md hover:bg-green-700 transition-colors">
                        <i class="fas fa-plus mr-2"></i>Adicionar Gasto Fixo
                    </button>
                </div>

                <!-- Fixed Expenses List -->
                <div class="overflow-x-auto">
                    <table class="min-w-full bg-white">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Item</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor Mensal</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data de Início</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data de Fim</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Observações</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                            </tr>
                        </thead>
                        <tbody id="gastos-fixos-list" class="bg-white divide-y divide-gray-200">
                            <!-- Fixed expenses will be populated here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </main>

    <script>
        // Data Storage
        let data = {
            gastos: JSON.parse(localStorage.getItem('gastos')) || [],
            rendas: JSON.parse(localStorage.getItem('rendas')) || [],
            poupanca: JSON.parse(localStorage.getItem('poupanca')) || [],
            metas: JSON.parse(localStorage.getItem('metas')) || [],
            gastosFixos: JSON.parse(localStorage.getItem('gastosFixos')) || []
        };

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            initializeYearSelectors();
            initializeEventListeners();
            renderAllTabs();
            updateDashboard();
        });

        // Generate years automatically
        function initializeYearSelectors() {
            const currentYear = new Date().getFullYear();
            const years = [];
            
            // Generate current year + next 10 years
            for (let i = 0; i <= 10; i++) {
                years.push(currentYear + i);
            }

            // Populate filter year
            const filterYear = document.getElementById('filter-year');
            filterYear.innerHTML = '<option value="">Todos</option>';
            years.forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                if (year === currentYear) {
                    option.selected = true;
                }
                filterYear.appendChild(option);
            });

            // Populate renda year
            const rendaYear = document.getElementById('renda-ano');
            rendaYear.innerHTML = '<option value="">Ano</option>';
            years.forEach(year => {
                const option = document.createElement('option');
                option.value = year;
                option.textContent = year;
                if (year === currentYear) {
                    option.selected = true;
                }
                rendaYear.appendChild(option);
            });
        }

        // Event Listeners
        function initializeEventListeners() {
            // Navigation
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    showTab(tabName);
                });
            });

            // Filters
            document.getElementById('apply-filters').addEventListener('click', updateDashboard);

            // Add buttons
            document.getElementById('add-gasto').addEventListener('click', addGasto);
            document.getElementById('add-renda').addEventListener('click', addRenda);
            document.getElementById('add-poupanca').addEventListener('click', addPoupanca);
            document.getElementById('add-meta').addEventListener('click', addMeta);
            document.getElementById('add-gasto-fixo').addEventListener('click', addGastoFixo);

            // Set current date
            document.getElementById('gasto-data').valueAsDate = new Date();
            document.getElementById('poupanca-data').valueAsDate = new Date();
        }

        // Tab Management
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active', 'text-blue-600', 'border-b-2', 'border-blue-600');
                btn.classList.add('text-gray-600');
            });

            document.getElementById(tabName).classList.remove('hidden');
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active', 'text-blue-600', 'border-b-2', 'border-blue-600');
            document.querySelector(`[data-tab="${tabName}"]`).classList.remove('text-gray-600');
        }

        // Add Functions
        function addGasto() {
            const data_input = document.getElementById('gasto-data').value;
            const descricao = document.getElementById('gasto-descricao').value;
            const categoria = document.getElementById('gasto-categoria').value;
            const valor = parseFloat(document.getElementById('gasto-valor').value);
            const forma = document.getElementById('gasto-forma').value;

            if (!data_input || !descricao || !categoria || !valor || !forma) {
                alert('Por favor, preencha todos os campos!');
                return;
            }

            const gasto = {
                id: Date.now(),
                data: data_input,
                descricao,
                categoria,
                valor,
                forma
            };

            data.gastos.push(gasto);
            saveData();
            renderGastos();
            updateDashboard();
            clearForm('gasto');
        }

        function addRenda() {
            const mes = document.getElementById('renda-mes').value;
            const ano = document.getElementById('renda-ano').value;
            const tipo = document.getElementById('renda-tipo').value;
            const valor = parseFloat(document.getElementById('renda-valor').value);
            const descricao = document.getElementById('renda-descricao').value;

            if (!mes || !ano || !tipo || !valor) {
                alert('Por favor, preencha todos os campos obrigatórios!');
                return;
            }

            const renda = {
                id: Date.now(),
                mes,
                ano,
                tipo,
                valor,
                descricao
            };

            data.rendas.push(renda);
            saveData();
            renderRendas();
            updateDashboard();
            clearForm('renda');
        }

        function addPoupanca() {
            const data_input = document.getElementById('poupanca-data').value;
            const tipo = document.getElementById('poupanca-tipo').value;
            const valor = parseFloat(document.getElementById('poupanca-valor').value);
            const descricao = document.getElementById('poupanca-descricao').value;

            if (!data_input || !tipo || !valor) {
                alert('Por favor, preencha todos os campos obrigatórios!');
                return;
            }

            // Calculate new balance
            const lastEntry = data.poupanca[data.poupanca.length - 1];
            const lastBalance = lastEntry ? lastEntry.saldo : 0;
            const newBalance = tipo === 'Depósito' ? lastBalance + valor : lastBalance - valor;

            const poupanca = {
                id: Date.now(),
                data: data_input,
                tipo,
                valor,
                saldo: newBalance,
                descricao
            };

            data.poupanca.push(poupanca);
            saveData();
            renderPoupanca();
            updateDashboard();
            clearForm('poupanca');
        }

        function addMeta() {
            const nome = document.getElementById('meta-nome').value;
            const valorAlvo = parseFloat(document.getElementById('meta-valor-alvo').value);
            const valorAtual = parseFloat(document.getElementById('meta-valor-atual').value) || 0;
            const dataLimite = document.getElementById('meta-data-limite').value;

            if (!nome || !valorAlvo || !dataLimite) {
                alert('Por favor, preencha todos os campos obrigatórios!');
                return;
            }

            const meta = {
                id: Date.now(),
                nome,
                valorAlvo,
                valorAtual,
                dataLimite
            };

            data.metas.push(meta);
            saveData();
            renderMetas();
            updateDashboard();
            clearForm('meta');
        }

        function addGastoFixo() {
            const item = document.getElementById('gasto-fixo-item').value;
            const valor = parseFloat(document.getElementById('gasto-fixo-valor').value);
            const inicio = document.getElementById('gasto-fixo-inicio').value;
            const fim = document.getElementById('gasto-fixo-fim').value;
            const obs = document.getElementById('gasto-fixo-obs').value;

            if (!item || !valor || !inicio) {
                alert('Por favor, preencha todos os campos obrigatórios!');
                return;
            }

            const gastoFixo = {
                id: Date.now(),
                item,
                valor,
                inicio,
                fim,
                obs
            };

            data.gastosFixos.push(gastoFixo);
            saveData();
            renderGastosFixos();
            updateDashboard();
            clearForm('gasto-fixo');
        }

        // Update Meta Value
        function updateMeta(id, increment) {
            const meta = data.metas.find(m => m.id === id);
            if (meta) {
                meta.valorAtual += increment;
                if (meta.valorAtual < 0) meta.valorAtual = 0;
                saveData();
                renderMetas();
                updateDashboard();
            }
        }

        // Delete Functions
        function deleteItem(type, id) {
            if (confirm('Tem certeza que deseja excluir este item?')) {
                data[type] = data[type].filter(item => item.id !== id);
                saveData();
                renderAllTabs();
                updateDashboard();
            }
        }

        // Render Functions
        function renderGastos() {
            const tbody = document.getElementById('gastos-list');
            tbody.innerHTML = '';

            data.gastos.forEach(gasto => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatDate(gasto.data)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${gasto.descricao}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${gasto.categoria}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatCurrency(gasto.valor)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${gasto.forma}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="deleteItem('gastos', ${gasto.id})" class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderRendas() {
            const tbody = document.getElementById('rendas-list');
            tbody.innerHTML = '';

            data.rendas.forEach(renda => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${renda.mes}/${renda.ano}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${renda.tipo}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatCurrency(renda.valor)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${renda.descricao || '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="deleteItem('rendas', ${renda.id})" class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderPoupanca() {
            const tbody = document.getElementById('poupanca-list');
            tbody.innerHTML = '';

            data.poupanca.forEach(poupanca => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatDate(poupanca.data)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${poupanca.tipo}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatCurrency(poupanca.valor)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatCurrency(poupanca.saldo)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${poupanca.descricao || '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="deleteItem('poupanca', ${poupanca.id})" class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderMetas() {
            const container = document.getElementById('metas-list');
            container.innerHTML = '';

            data.metas.forEach(meta => {
                const progress = (meta.valorAtual / meta.valorAlvo) * 100;
                const progressClass = progress >= 100 ? 'bg-green-500' : progress >= 50 ? 'bg-yellow-500' : 'bg-red-500';
                
                const div = document.createElement('div');
                div.className = 'border rounded-lg p-4';
                div.innerHTML = `
                    <div class="flex justify-between items-start mb-2">
                        <h4 class="text-lg font-semibold">${meta.nome}</h4>
                        <div class="flex space-x-2">
                            <button onclick="updateMeta(${meta.id}, 100)" class="bg-green-500 text-white px-2 py-1 rounded text-sm">+100</button>
                            <button onclick="updateMeta(${meta.id}, 500)" class="bg-green-600 text-white px-2 py-1 rounded text-sm">+500</button>
                            <button onclick="updateMeta(${meta.id}, -100)" class="bg-red-500 text-white px-2 py-1 rounded text-sm">-100</button>
                            <button onclick="deleteItem('metas', ${meta.id})" class="bg-red-600 text-white px-2 py-1 rounded text-sm">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4 mb-3">
                        <div>
                            <span class="text-sm text-gray-600">Valor Alvo:</span>
                            <span class="font-semibold">${formatCurrency(meta.valorAlvo)}</span>
                        </div>
                        <div>
                            <span class="text-sm text-gray-600">Valor Atual:</span>
                            <span class="font-semibold">${formatCurrency(meta.valorAtual)}</span>
                        </div>
                        <div>
                            <span class="text-sm text-gray-600">Data Limite:</span>
                            <span class="font-semibold">${formatDate(meta.dataLimite)}</span>
                        </div>
                        <div>
                            <span class="text-sm text-gray-600">Progresso:</span>
                            <span class="font-semibold">${progress.toFixed(1)}%</span>
                        </div>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="h-2 rounded-full ${progressClass}" style="width: ${Math.min(progress, 100)}%"></div>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function renderGastosFixos() {
            const tbody = document.getElementById('gastos-fixos-list');
            tbody.innerHTML = '';

            data.gastosFixos.forEach(gastoFixo => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${gastoFixo.item}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatCurrency(gastoFixo.valor)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${formatDate(gastoFixo.inicio)}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${gastoFixo.fim ? formatDate(gastoFixo.fim) : '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">${gastoFixo.obs || '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                        <button onclick="deleteItem('gastosFixos', ${gastoFixo.id})" class="text-red-600 hover:text-red-900">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderAllTabs() {
            renderGastos();
            renderRendas();
            renderPoupanca();
            renderMetas();
            renderGastosFixos();
        }

        // Dashboard Updates
        function updateDashboard() {
            const filters = getFilters();
            const filteredData = applyFilters(filters);
            
            updateSummaryCards(filteredData);
            updateCharts(filteredData);
        }

        function getFilters() {
            return {
                year: document.getElementById('filter-year').value,
                month: document.getElementById('filter-month').value,
                category: document.getElementById('filter-category').value
            };
        }

        function applyFilters(filters) {
            const filtered = {
                gastos: data.gastos.filter(item => {
                    const itemDate = new Date(item.data);
                    const itemYear = itemDate.getFullYear().toString();
                    const itemMonth = (itemDate.getMonth() + 1).toString().padStart(2, '0');
                    
                    return (!filters.year || itemYear === filters.year) &&
                           (!filters.month || itemMonth === filters.month) &&
                           (!filters.category || item.categoria === filters.category);
                }),
                rendas: data.rendas.filter(item => {
                    return (!filters.year || item.ano === filters.year) &&
                           (!filters.month || item.mes === filters.month);
                }),
                poupanca: data.poupanca.filter(item => {
                    const itemDate = new Date(item.data);
                    const itemYear = itemDate.getFullYear().toString();
                    const itemMonth = (itemDate.getMonth() + 1).toString().padStart(2, '0');
                    
                    return (!filters.year || itemYear === filters.year) &&
                           (!filters.month || itemMonth === filters.month);
                })
            };
            
            return filtered;
        }

        function updateSummaryCards(filteredData) {
            const totalRenda = filteredData.rendas.reduce((sum, renda) => sum + renda.valor, 0);
            const totalGastos = filteredData.gastos.reduce((sum, gasto) => sum + gasto.valor, 0);
            const totalPoupado = filteredData.poupanca.reduce((sum, poupanca) => {
                return sum + (poupanca.tipo === 'Depósito' ? poupanca.valor : -poupanca.valor);
            }, 0);
            const saldoAtual = totalRenda - totalGastos + totalPoupado;

            document.getElementById('total-renda').textContent = formatCurrency(totalRenda);
            document.getElementById('total-gastos').textContent = formatCurrency(totalGastos);
            document.getElementById('total-poupado').textContent = formatCurrency(totalPoupado);
            document.getElementById('saldo-atual').textContent = formatCurrency(saldoAtual);
        }

        // Chart Management
        let charts = {};

        function updateCharts(filteredData) {
            updateCategoryChart(filteredData.gastos);
            updateSavingsChart(filteredData.poupanca);
            updateExpensesChart(filteredData);
        }

        function updateCategoryChart(gastos) {
            const ctx = document.getElementById('category-chart').getContext('2d');
            
            if (charts.category) {
                charts.category.destroy();
            }

            const categories = {};
            gastos.forEach(gasto => {
                categories[gasto.categoria] = (categories[gasto.categoria] || 0) + gasto.valor;
            });

            charts.category = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: Object.keys(categories),
                    datasets: [{
                        data: Object.values(categories),
                        backgroundColor: [
                            '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
                            '#9966FF', '#FF9F40', '#FF6384', '#C9CBCF'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function updateSavingsChart(poupanca) {
            const ctx = document.getElementById('savings-chart').getContext('2d');
            
            if (charts.savings) {
                charts.savings.destroy();
            }

            const labels = poupanca.map(p => formatDate(p.data));
            const data = poupanca.map(p => p.saldo);

            charts.savings = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Saldo da Poupança',
                        data: data,
                        borderColor: '#36A2EB',
                        backgroundColor: 'rgba(54, 162, 235, 0.1)',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function updateExpensesChart(filteredData) {
            const ctx = document.getElementById('expenses-chart').getContext('2d');
            
            if (charts.expenses) {
                charts.expenses.destroy();
            }

            const gastosVariaveis = filteredData.gastos.reduce((sum, gasto) => sum + gasto.valor, 0);
            const gastosFixos = data.gastosFixos.reduce((sum, gasto) => sum + gasto.valor, 0);

            charts.expenses = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Gastos Variáveis', 'Gastos Fixos'],
                    datasets: [{
                        label: 'Valor',
                        data: [gastosVariaveis, gastosFixos],
                        backgroundColor: ['#FF6384', '#36A2EB']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Utility Functions
        function formatCurrency(value) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(value);
        }

        function formatDate(dateString) {
            return new Date(dateString).toLocaleDateString('pt-BR');
        }

        function clearForm(type) {
            const forms = {
                'gasto': ['gasto-data', 'gasto-descricao', 'gasto-categoria', 'gasto-valor', 'gasto-forma'],
                'renda': ['renda-mes', 'renda-ano', 'renda-tipo', 'renda-valor', 'renda-descricao'],
                'poupanca': ['poupanca-data', 'poupanca-tipo', 'poupanca-valor', 'poupanca-descricao'],
                'meta': ['meta-nome', 'meta-valor-alvo', 'meta-valor-atual', 'meta-data-limite'],
                'gasto-fixo': ['gasto-fixo-item', 'gasto-fixo-valor', 'gasto-fixo-inicio', 'gasto-fixo-fim', 'gasto-fixo-obs']
            };

            forms[type].forEach(id => {
                const element = document.getElementById(id);
                if (element.type === 'date' && id.includes('data')) {
                    element.valueAsDate = new Date();
                } else {
                    element.value = '';
                }
            });
        }

        function saveData() {
            Object.keys(data).forEach(key => {
                localStorage.setItem(key, JSON.stringify(data[key]));
            });
        }
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDnMl%2BYsQki3SI%2FuaUtaG7QIPyhSIRO3RBE8KntcGPCJVYqQWOWQt73o1gJmfMNC7%2FbjYLsTnhnLXOQv1XRgbvBNM5hnqhHldR8CjNzLXH1DbGpgl0OUy8yGDYqIm0vpfoDRaPZ3bDGj6Hu2%2B6VpVk3iNtRHn2SuEFdWBcXV0mInd0AtG7sOiJGw4zdpc0WA9i2tDs3ap%2F8gKIQLa871Z4jLUqynuvg7iWE%2BZLwQn9QymE30HEMAfZxq9N911xOeCG6ict1aSjGIlLMrDQj3V7hmLeebn98Atkq7j7WgLGzXtUvU8Dtc94rh0bjA6aBrCWp%2BkQ%2FF%2FTr3bxzPb183z1OathqGFNTX8Th215YyXXrLo3ibSdvGLlH7DTBSvzBNngjT0noFvdT0iZdQdk9FRU7eNS%2BWew2qnvLZqlP2mVtowqHyNcvkR2%2Fm%2FBpIqJvPtHMNgJhNvoDr4hV5wBz%2FqpXD5uEKZSt6ArQvlVW%2FJhZ9mjkaBbHUTFBZyNHMOWZaJmARdgDE8v0CvQBTJXF357YE%3D";
        window.__genspark_locale = "pt-BR";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDnMl+YsQki3SI/uaUtaG7QIPyhSIRO3RBE8KntcGPCJVYqQWOWQt73o1gJmfMNC7/bjYLsTnhnLXOQv1XRgbvBNM5hnqhHldR8CjNzLXH1DbGpgl0OUy8yGDYqIm0vpfoDRaPZ3bDGj6Hu2+6VpVk3iNtRHn2SuEFdWBcXV0mInd0AtG7sOiJGw4zdpc0WA9i2tDs3ap/8gKIQLa871Z4jLUqynuvg7iWE+ZLwQn9QymE30HEMAfZxq9N911xOeCG6ict1aSjGIlLMrDQj3V7hmLeebn98Atkq7j7WgLGzXtUvU8Dtc94rh0bjA6aBrCWp+kQ/F/Tr3bxzPb183z1OathqGFNTX8Th215YyXXrLo3ibSdvGLlH7DTBSvzBNngjT0noFvdT0iZdQdk9FRU7eNS+Wew2qnvLZqlP2mVtowqHyNcvkR2/m/BpIqJvPtHMNgJhNvoDr4hV5wBz/qpXD5uEKZSt6ArQvlVW/JhZ9mjkaBbHUTFBZyNHMOWZaJmARdgDE8v0CvQBTJXF357YE=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    