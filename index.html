<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Controle Financeiro Familiar</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=kFxmLsL_mKKQyJ7Tbt1slkceU0JA8qRxagQdtEcKHmZ7Rhf9WHcKUlcHESY9UuIuZ-gzhoshyINwzOAqXf2o3Kjv02_1EgC0EqokCZ-zucr3Ezf0VLCxzeByJ9ln8mW_4FWlhwFCy157oHu9js5yP8eZ3YttvlRsdQ8Zb9_Qnv1d0Wgm4uJmy8DGQzXa_RAx34NKwdYkoaioBEmEUuL-aP6yCj2J6ibnTQmk8BmOfQps2PXq_7rMU7MJlCFGcJrLQQZ8E4yGHQeq85dJ0iNCsfQo_H7N4gPnrxB_FepA-5GCmC-dOr9bSRmw6mMyIib-gSLAiw2r2iVe-iu4IczJwbpkkwFL6ziod-EeLbYNcAWkYpI2FEzsU0irLwBe41je15Hnr65g4rOhFw8-u-0okxpmcofeuZKrLysiC6o_nBsuPyGKoS_fwSnzPcDw7rk-" charset="UTF-8"></script><script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .tab-button.active { background-color: #3b82f6; color: white; }
        .card { transition: all 0.3s ease; }
        .card:hover { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .metric-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .metric-card-green { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
        .metric-card-red { background: linear-gradient(135deg, #fc466b 0%, #3f5efb 100%); }
        .metric-card-blue { background: linear-gradient(135deg, #3b82f6 0%, #1e40af 100%); }
        .chart-container { height: 400px; }
        .btn-primary { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .btn-primary:hover { background: linear-gradient(135deg, #764ba2 0%, #667eea 100%); }
        .progress-bar { background: linear-gradient(90deg, #11998e 0%, #38ef7d 100%); }
    </style>
</head>
<body class="bg-gray-50">
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-4">
                    <i class="fas fa-chart-line text-2xl text-blue-600"></i>
                    <h1 class="text-2xl font-bold text-gray-800">Sistema Financeiro Familiar</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-sm text-gray-600">Última atualização: <span id="lastUpdate">--</span></span>
                    <button onclick="exportData()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">
                        <i class="fas fa-download mr-2"></i>Exportar
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <div class="max-w-7xl mx-auto px-4 py-8">
        <!-- Filtros -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-xl font-bold mb-4">Filtros</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Ano</label>
                    <select id="filterYear" class="w-full border border-gray-300 rounded-md px-3 py-2">
                        <option value="">Todos</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Mês</label>
                    <select id="filterMonth" class="w-full border border-gray-300 rounded-md px-3 py-2">
                        <option value="">Todos</option>
                        <option value="01">Janeiro</option>
                        <option value="02">Fevereiro</option>
                        <option value="03">Março</option>
                        <option value="04">Abril</option>
                        <option value="05">Maio</option>
                        <option value="06">Junho</option>
                        <option value="07">Julho</option>
                        <option value="08">Agosto</option>
                        <option value="09">Setembro</option>
                        <option value="10">Outubro</option>
                        <option value="11">Novembro</option>
                        <option value="12">Dezembro</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Categoria</label>
                    <select id="filterCategory" class="w-full border border-gray-300 rounded-md px-3 py-2">
                        <option value="">Todas</option>
                        <option value="Alimentação">Alimentação</option>
                        <option value="Transporte">Transporte</option>
                        <option value="Moradia">Moradia</option>
                        <option value="Lazer">Lazer</option>
                        <option value="Saúde">Saúde</option>
                        <option value="Educação">Educação</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>
                <div class="flex items-end space-x-2">
                    <button onclick="applyFilters()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">
                        <i class="fas fa-filter mr-2"></i>Aplicar
                    </button>
                    <button onclick="clearFilters()" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded">
                        <i class="fas fa-times mr-2"></i>Limpar
                    </button>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="bg-white rounded-lg shadow-md mb-8">
            <div class="flex flex-wrap border-b">
                <button class="tab-button active px-6 py-3 text-sm font-medium" onclick="showTab('dashboard')">
                    <i class="fas fa-tachometer-alt mr-2"></i>Dashboard
                </button>
                <button class="tab-button px-6 py-3 text-sm font-medium" onclick="showTab('rendas')">
                    <i class="fas fa-money-bill-wave mr-2"></i>Rendas
                </button>
                <button class="tab-button px-6 py-3 text-sm font-medium" onclick="showTab('gastos')">
                    <i class="fas fa-shopping-cart mr-2"></i>Gastos
                </button>
                <button class="tab-button px-6 py-3 text-sm font-medium" onclick="showTab('gastos-fixos')">
                    <i class="fas fa-home mr-2"></i>Gastos Fixos
                </button>
                <button class="tab-button px-6 py-3 text-sm font-medium" onclick="showTab('poupanca')">
                    <i class="fas fa-piggy-bank mr-2"></i>Poupança
                </button>
                <button class="tab-button px-6 py-3 text-sm font-medium" onclick="showTab('metas')">
                    <i class="fas fa-bullseye mr-2"></i>Metas
                </button>
            </div>

            <!-- Dashboard Tab -->
            <div id="dashboard" class="tab-content active p-6">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
                    <div class="card metric-card text-white rounded-lg p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white opacity-75">Renda Total</p>
                                <p class="text-2xl font-bold" id="totalRenda">R$ 0,00</p>
                            </div>
                            <i class="fas fa-arrow-up text-3xl opacity-75"></i>
                        </div>
                    </div>
                    <div class="card metric-card-green text-white rounded-lg p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white opacity-75">Total Poupado</p>
                                <p class="text-2xl font-bold" id="totalPoupanca">R$ 0,00</p>
                            </div>
                            <i class="fas fa-piggy-bank text-3xl opacity-75"></i>
                        </div>
                    </div>
                    <div class="card metric-card-red text-white rounded-lg p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white opacity-75">Total Gastos</p>
                                <p class="text-2xl font-bold" id="totalGastos">R$ 0,00</p>
                            </div>
                            <i class="fas fa-shopping-cart text-3xl opacity-75"></i>
                        </div>
                    </div>
                    <div class="card metric-card-blue text-white rounded-lg p-6">
                        <div class="flex items-center justify-between">
                            <div>
                                <p class="text-white opacity-75">Saldo Atual</p>
                                <p class="text-2xl font-bold" id="saldoAtual">R$ 0,00</p>
                            </div>
                            <i class="fas fa-wallet text-3xl opacity-75"></i>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Gastos por Categoria</h3>
                        <div class="chart-container">
                            <canvas id="categoryChart"></canvas>
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Evolução da Poupança</h3>
                        <div class="chart-container">
                            <canvas id="savingsChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Rendas Tab -->
            <div id="rendas" class="tab-content p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Adicionar Renda</h3>
                        <form id="rendaForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Data</label>
                                <input type="date" id="rendaData" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Fonte</label>
                                <input type="text" id="rendaFonte" class="w-full border border-gray-300 rounded-md px-3 py-2" placeholder="Ex: Salário, Freelance, Vendas..." required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Pessoa</label>
                                <select id="rendaPessoa" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                                    <option value="Titular">Titular</option>
                                    <option value="Cônjuge">Cônjuge</option>
                                    <option value="Ambos">Ambos</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor</label>
                                <input type="number" id="rendaValor" class="w-full border border-gray-300 rounded-md px-3 py-2" step="0.01" min="0" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Observações</label>
                                <input type="text" id="rendaObs" class="w-full border border-gray-300 rounded-md px-3 py-2" placeholder="Opcional">
                            </div>
                            <button type="submit" class="w-full btn-primary text-white px-4 py-2 rounded hover:bg-blue-600">
                                <i class="fas fa-plus mr-2"></i>Adicionar Renda
                            </button>
                        </form>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Histórico de Rendas</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-2 text-left">Data</th>
                                        <th class="px-4 py-2 text-left">Fonte</th>
                                        <th class="px-4 py-2 text-left">Pessoa</th>
                                        <th class="px-4 py-2 text-left">Valor</th>
                                        <th class="px-4 py-2 text-left">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="rendasList">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gastos Tab -->
            <div id="gastos" class="tab-content p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Adicionar Gasto</h3>
                        <form id="gastoForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Data</label>
                                <input type="date" id="gastoData" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
                                <input type="text" id="gastoDescricao" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Categoria</label>
                                <select id="gastoCategoria" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                                    <option value="">Selecione...</option>
                                    <option value="Alimentação">Alimentação</option>
                                    <option value="Transporte">Transporte</option>
                                    <option value="Moradia">Moradia</option>
                                    <option value="Lazer">Lazer</option>
                                    <option value="Saúde">Saúde</option>
                                    <option value="Educação">Educação</option>
                                    <option value="Outros">Outros</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor</label>
                                <input type="number" id="gastoValor" class="w-full border border-gray-300 rounded-md px-3 py-2" step="0.01" min="0" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Forma de Pagamento</label>
                                <select id="gastoFormaPagamento" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                                    <option value="">Selecione...</option>
                                    <option value="Dinheiro">Dinheiro</option>
                                    <option value="Cartão de Crédito">Cartão de Crédito</option>
                                    <option value="Cartão de Débito">Cartão de Débito</option>
                                    <option value="Transferência">Transferência</option>
                                    <option value="Boleto">Boleto</option>
                                </select>
                            </div>
                            <button type="submit" class="w-full btn-primary text-white px-4 py-2 rounded hover:bg-blue-600">
                                <i class="fas fa-plus mr-2"></i>Adicionar Gasto
                            </button>
                        </form>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Lista de Gastos</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-2 text-left">Data</th>
                                        <th class="px-4 py-2 text-left">Descrição</th>
                                        <th class="px-4 py-2 text-left">Categoria</th>
                                        <th class="px-4 py-2 text-left">Valor</th>
                                        <th class="px-4 py-2 text-left">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="gastosList">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Gastos Fixos Tab -->
            <div id="gastos-fixos" class="tab-content p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Adicionar Gasto Fixo</h3>
                        <form id="gastoFixoForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Item</label>
                                <input type="text" id="gastoFixoItem" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor Mensal</label>
                                <input type="number" id="gastoFixoValor" class="w-full border border-gray-300 rounded-md px-3 py-2" step="0.01" min="0" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Data de Início</label>
                                <input type="date" id="gastoFixoInicio" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Data de Fim</label>
                                <input type="date" id="gastoFixoFim" class="w-full border border-gray-300 rounded-md px-3 py-2">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Observações</label>
                                <input type="text" id="gastoFixoObs" class="w-full border border-gray-300 rounded-md px-3 py-2">
                            </div>
                            <button type="submit" class="w-full btn-primary text-white px-4 py-2 rounded hover:bg-blue-600">
                                <i class="fas fa-plus mr-2"></i>Adicionar Gasto Fixo
                            </button>
                        </form>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Lista de Gastos Fixos</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-2 text-left">Item</th>
                                        <th class="px-4 py-2 text-left">Valor Mensal</th>
                                        <th class="px-4 py-2 text-left">Status</th>
                                        <th class="px-4 py-2 text-left">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="gastosFixosList">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Poupança Tab -->
            <div id="poupanca" class="tab-content p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Movimentação da Poupança</h3>
                        <form id="poupancaForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Data</label>
                                <input type="date" id="poupancaData" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Tipo</label>
                                <select id="poupancaTipo" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                                    <option value="">Selecione...</option>
                                    <option value="Depósito">Depósito</option>
                                    <option value="Retirada">Retirada</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor</label>
                                <input type="number" id="poupancaValor" class="w-full border border-gray-300 rounded-md px-3 py-2" step="0.01" min="0" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Observações</label>
                                <input type="text" id="poupancaObs" class="w-full border border-gray-300 rounded-md px-3 py-2">
                            </div>
                            <button type="submit" class="w-full btn-primary text-white px-4 py-2 rounded hover:bg-blue-600">
                                <i class="fas fa-plus mr-2"></i>Adicionar Movimentação
                            </button>
                        </form>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Histórico da Poupança</h3>
                        <div class="mb-4 p-4 bg-blue-50 rounded-lg">
                            <p class="text-sm text-gray-600">Saldo Atual da Poupança</p>
                            <p class="text-2xl font-bold text-blue-600" id="saldoPoupanca">R$ 0,00</p>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-2 text-left">Data</th>
                                        <th class="px-4 py-2 text-left">Tipo</th>
                                        <th class="px-4 py-2 text-left">Valor</th>
                                        <th class="px-4 py-2 text-left">Ações</th>
                                    </tr>
                                </thead>
                                <tbody id="poupancaList">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Metas Tab -->
            <div id="metas" class="tab-content p-6">
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Adicionar Meta</h3>
                        <form id="metaForm" class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Nome da Meta</label>
                                <input type="text" id="metaNome" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor Alvo</label>
                                <input type="number" id="metaValorAlvo" class="w-full border border-gray-300 rounded-md px-3 py-2" step="0.01" min="0" required>
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Valor Atual</label>
                                <input type="number" id="metaValorAtual" class="w-full border border-gray-300 rounded-md px-3 py-2" step="0.01" min="0" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Data Limite</label>
                                <input type="date" id="metaDataLimite" class="w-full border border-gray-300 rounded-md px-3 py-2" required>
                            </div>
                            <button type="submit" class="w-full btn-primary text-white px-4 py-2 rounded hover:bg-blue-600">
                                <i class="fas fa-plus mr-2"></i>Adicionar Meta
                            </button>
                        </form>
                    </div>
                    <div class="bg-white p-6 rounded-lg shadow-md">
                        <h3 class="text-lg font-bold mb-4">Minhas Metas</h3>
                        <div id="metasList" class="space-y-4">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sistema de dados
        class FinanceManager {
            constructor() {
                this.data = {
                    rendas: JSON.parse(localStorage.getItem('rendas') || '[]'),
                    gastos: JSON.parse(localStorage.getItem('gastos') || '[]'),
                    gastosFixos: JSON.parse(localStorage.getItem('gastosFixos') || '[]'),
                    poupanca: JSON.parse(localStorage.getItem('poupanca') || '[]'),
                    metas: JSON.parse(localStorage.getItem('metas') || '[]')
                };
                this.filters = {
                    year: '',
                    month: '',
                    category: ''
                };
                this.charts = {};
                this.initializeFilters();
                this.initializeForms();
                this.renderAll();
                this.updateMetrics();
            }

            initializeFilters() {
                const currentYear = new Date().getFullYear();
                const yearSelect = document.getElementById('filterYear');
                for (let year = currentYear - 2; year <= currentYear + 2; year++) {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    yearSelect.appendChild(option);
                }
            }

            initializeForms() {
                document.getElementById('rendaForm').addEventListener('submit', (e) => this.addRenda(e));
                document.getElementById('gastoForm').addEventListener('submit', (e) => this.addGasto(e));
                document.getElementById('gastoFixoForm').addEventListener('submit', (e) => this.addGastoFixo(e));
                document.getElementById('poupancaForm').addEventListener('submit', (e) => this.addPoupanca(e));
                document.getElementById('metaForm').addEventListener('submit', (e) => this.addMeta(e));
            }

            save() {
                localStorage.setItem('rendas', JSON.stringify(this.data.rendas));
                localStorage.setItem('gastos', JSON.stringify(this.data.gastos));
                localStorage.setItem('gastosFixos', JSON.stringify(this.data.gastosFixos));
                localStorage.setItem('poupanca', JSON.stringify(this.data.poupanca));
                localStorage.setItem('metas', JSON.stringify(this.data.metas));
                document.getElementById('lastUpdate').textContent = new Date().toLocaleString();
            }

            addRenda(e) {
                e.preventDefault();
                const renda = {
                    id: Date.now(),
                    data: document.getElementById('rendaData').value,
                    fonte: document.getElementById('rendaFonte').value,
                    pessoa: document.getElementById('rendaPessoa').value,
                    valor: parseFloat(document.getElementById('rendaValor').value),
                    observacoes: document.getElementById('rendaObs').value
                };
                this.data.rendas.push(renda);
                this.save();
                this.renderRendas();
                this.updateMetrics();
                document.getElementById('rendaForm').reset();
            }

            addGasto(e) {
                e.preventDefault();
                const gasto = {
                    id: Date.now(),
                    data: document.getElementById('gastoData').value,
                    descricao: document.getElementById('gastoDescricao').value,
                    categoria: document.getElementById('gastoCategoria').value,
                    valor: parseFloat(document.getElementById('gastoValor').value),
                    formaPagamento: document.getElementById('gastoFormaPagamento').value
                };
                this.data.gastos.push(gasto);
                this.save();
                this.renderGastos();
                this.updateMetrics();
                this.updateCharts();
                document.getElementById('gastoForm').reset();
            }

            addGastoFixo(e) {
                e.preventDefault();
                const gastoFixo = {
                    id: Date.now(),
                    item: document.getElementById('gastoFixoItem').value,
                    valor: parseFloat(document.getElementById('gastoFixoValor').value),
                    dataInicio: document.getElementById('gastoFixoInicio').value,
                    dataFim: document.getElementById('gastoFixoFim').value,
                    observacoes: document.getElementById('gastoFixoObs').value
                };
                this.data.gastosFixos.push(gastoFixo);
                this.save();
                this.renderGastosFixos();
                this.updateMetrics();
                document.getElementById('gastoFixoForm').reset();
            }

            addPoupanca(e) {
                e.preventDefault();
                const poupanca = {
                    id: Date.now(),
                    data: document.getElementById('poupancaData').value,
                    tipo: document.getElementById('poupancaTipo').value,
                    valor: parseFloat(document.getElementById('poupancaValor').value),
                    observacoes: document.getElementById('poupancaObs').value
                };
                this.data.poupanca.push(poupanca);
                this.save();
                this.renderPoupanca();
                this.updateMetrics();
                this.updateCharts();
                document.getElementById('poupancaForm').reset();
            }

            addMeta(e) {
                e.preventDefault();
                const meta = {
                    id: Date.now(),
                    nome: document.getElementById('metaNome').value,
                    valorAlvo: parseFloat(document.getElementById('metaValorAlvo').value),
                    valorAtual: parseFloat(document.getElementById('metaValorAtual').value),
                    dataLimite: document.getElementById('metaDataLimite').value,
                    status: 'Em Progresso'
                };
                this.data.metas.push(meta);
                this.save();
                this.renderMetas();
                document.getElementById('metaForm').reset();
            }

            updateMeta(id, valor) {
                const meta = this.data.metas.find(m => m.id === id);
                if (meta) {
                    meta.valorAtual += valor;
                    if (meta.valorAtual >= meta.valorAlvo) {
                        meta.status = 'Concluída';
                    }
                    this.save();
                    this.renderMetas();
                }
            }

            deleteMeta(id) {
                this.data.metas = this.data.metas.filter(m => m.id !== id);
                this.save();
                this.renderMetas();
            }

            deleteItem(type, id) {
                this.data[type] = this.data[type].filter(item => item.id !== id);
                this.save();
                this.renderAll();
                this.updateMetrics();
                this.updateCharts();
            }

            applyFilters() {
                this.filters.year = document.getElementById('filterYear').value;
                this.filters.month = document.getElementById('filterMonth').value;
                this.filters.category = document.getElementById('filterCategory').value;
                this.renderAll();
                this.updateMetrics();
                this.updateCharts();
            }

            clearFilters() {
                document.getElementById('filterYear').value = '';
                document.getElementById('filterMonth').value = '';
                document.getElementById('filterCategory').value = '';
                this.filters = { year: '', month: '', category: '' };
                this.renderAll();
                this.updateMetrics();
                this.updateCharts();
            }

            filterData(data, dateField = 'data') {
                return data.filter(item => {
                    const itemDate = new Date(item[dateField]);
                    const itemYear = itemDate.getFullYear().toString();
                    const itemMonth = (itemDate.getMonth() + 1).toString().padStart(2, '0');
                    
                    let matches = true;
                    
                    if (this.filters.year && itemYear !== this.filters.year) {
                        matches = false;
                    }
                    
                    if (this.filters.month && itemMonth !== this.filters.month) {
                        matches = false;
                    }
                    
                    if (this.filters.category && item.categoria !== this.filters.category) {
                        matches = false;
                    }
                    
                    return matches;
                });
            }

            renderRendas() {
                const list = document.getElementById('rendasList');
                const filteredRendas = this.filterData(this.data.rendas);
                
                list.innerHTML = filteredRendas.map(renda => `
                    <tr>
                        <td class="px-4 py-2">${new Date(renda.data).toLocaleDateString()}</td>
                        <td class="px-4 py-2">${renda.fonte}</td>
                        <td class="px-4 py-2">${renda.pessoa}</td>
                        <td class="px-4 py-2">R$ ${renda.valor.toFixed(2)}</td>
                        <td class="px-4 py-2">
                            <button onclick="financeManager.deleteItem('rendas', ${renda.id})" 
                                    class="text-red-500 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }

            renderGastos() {
                const list = document.getElementById('gastosList');
                const filteredGastos = this.filterData(this.data.gastos);
                
                list.innerHTML = filteredGastos.map(gasto => `
                    <tr>
                        <td class="px-4 py-2">${new Date(gasto.data).toLocaleDateString()}</td>
                        <td class="px-4 py-2">${gasto.descricao}</td>
                        <td class="px-4 py-2">${gasto.categoria}</td>
                        <td class="px-4 py-2">R$ ${gasto.valor.toFixed(2)}</td>
                        <td class="px-4 py-2">
                            <button onclick="financeManager.deleteItem('gastos', ${gasto.id})" 
                                    class="text-red-500 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }

            renderGastosFixos() {
                const list = document.getElementById('gastosFixosList');
                const today = new Date();
                
                list.innerHTML = this.data.gastosFixos.map(gasto => {
                    const inicio = new Date(gasto.dataInicio);
                    const fim = gasto.dataFim ? new Date(gasto.dataFim) : null;
                    let status = 'Ativo';
                    
                    if (today < inicio) {
                        status = 'Futuro';
                    } else if (fim && today > fim) {
                        status = 'Inativo';
                    }
                    
                    return `
                        <tr>
                            <td class="px-4 py-2">${gasto.item}</td>
                            <td class="px-4 py-2">R$ ${gasto.valor.toFixed(2)}</td>
                            <td class="px-4 py-2">
                                <span class="px-2 py-1 text-xs rounded-full ${status === 'Ativo' ? 'bg-green-100 text-green-800' : status === 'Futuro' ? 'bg-yellow-100 text-yellow-800' : 'bg-red-100 text-red-800'}">
                                    ${status}
                                </span>
                            </td>
                            <td class="px-4 py-2">
                                <button onclick="financeManager.deleteItem('gastosFixos', ${gasto.id})" 
                                        class="text-red-500 hover:text-red-700">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </td>
                        </tr>
                    `;
                }).join('');
            }

            renderPoupanca() {
                const list = document.getElementById('poupancaList');
                const filteredPoupanca = this.filterData(this.data.poupanca);
                
                list.innerHTML = filteredPoupanca.map(poupanca => `
                    <tr>
                        <td class="px-4 py-2">${new Date(poupanca.data).toLocaleDateString()}</td>
                        <td class="px-4 py-2">
                            <span class="px-2 py-1 text-xs rounded-full ${poupanca.tipo === 'Depósito' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                ${poupanca.tipo}
                            </span>
                        </td>
                        <td class="px-4 py-2">R$ ${poupanca.valor.toFixed(2)}</td>
                        <td class="px-4 py-2">
                            <button onclick="financeManager.deleteItem('poupanca', ${poupanca.id})" 
                                    class="text-red-500 hover:text-red-700">
                                <i class="fas fa-trash"></i>
                            </button>
                        </td>
                    </tr>
                `).join('');
            }

            renderMetas() {
                const list = document.getElementById('metasList');
                
                list.innerHTML = this.data.metas.map(meta => {
                    const progresso = (meta.valorAtual / meta.valorAlvo) * 100;
                    const dataLimite = new Date(meta.dataLimite);
                    const hoje = new Date();
                    const diasRestantes = Math.ceil((dataLimite - hoje) / (1000 * 60 * 60 * 24));
                    
                    return `
                        <div class="border rounded-lg p-4">
                            <div class="flex justify-between items-start mb-2">
                                <h4 class="font-bold">${meta.nome}</h4>
                                <span class="px-2 py-1 text-xs rounded-full ${meta.status === 'Concluída' ? 'bg-green-100 text-green-800' : 'bg-yellow-100 text-yellow-800'}">
                                    ${meta.status}
                                </span>
                            </div>
                            <div class="mb-2">
                                <div class="flex justify-between text-sm text-gray-600">
                                    <span>R$ ${meta.valorAtual.toFixed(2)} / R$ ${meta.valorAlvo.toFixed(2)}</span>
                                    <span>${progresso.toFixed(1)}%</span>
                                </div>
                                <div class="w-full bg-gray-200 rounded-full h-2">
                                    <div class="progress-bar h-2 rounded-full" style="width: ${Math.min(progresso, 100)}%"></div>
                                </div>
                            </div>
                            <div class="text-sm text-gray-600 mb-3">
                                <span>Prazo: ${dataLimite.toLocaleDateString()}</span>
                                <span class="ml-2">(${diasRestantes > 0 ? diasRestantes + ' dias restantes' : 'Prazo expirado'})</span>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="financeManager.promptUpdateMeta(${meta.id})" 
                                        class="bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm">
                                    <i class="fas fa-plus mr-1"></i>Adicionar
                                </button>
                                <button onclick="financeManager.deleteMeta(${meta.id})" 
                                        class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">
                                    <i class="fas fa-trash mr-1"></i>Excluir
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
            }

            promptUpdateMeta(id) {
                const valor = prompt('Quanto deseja adicionar ao progresso da meta?');
                if (valor && !isNaN(valor) && parseFloat(valor) > 0) {
                    this.updateMeta(id, parseFloat(valor));
                }
            }

            updateMetrics() {
                const filteredRendas = this.filterData(this.data.rendas);
                const filteredGastos = this.filterData(this.data.gastos);
                const filteredPoupanca = this.filterData(this.data.poupanca);
                
                const totalRendas = filteredRendas.reduce((sum, renda) => sum + renda.valor, 0);
                const totalGastos = filteredGastos.reduce((sum, gasto) => sum + gasto.valor, 0);
                
                const totalPoupanca = filteredPoupanca.reduce((sum, poupanca) => {
                    return sum + (poupanca.tipo === 'Depósito' ? poupanca.valor : -poupanca.valor);
                }, 0);
                
                const saldoAtual = totalRendas - totalGastos;
                
                document.getElementById('totalRenda').textContent = `R$ ${totalRendas.toFixed(2)}`;
                document.getElementById('totalGastos').textContent = `R$ ${totalGastos.toFixed(2)}`;
                document.getElementById('totalPoupanca').textContent = `R$ ${totalPoupanca.toFixed(2)}`;
                document.getElementById('saldoAtual').textContent = `R$ ${saldoAtual.toFixed(2)}`;
                document.getElementById('saldoPoupanca').textContent = `R$ ${totalPoupanca.toFixed(2)}`;
            }

            updateCharts() {
                this.updateCategoryChart();
                this.updateSavingsChart();
            }

            updateCategoryChart() {
                const ctx = document.getElementById('categoryChart').getContext('2d');
                const filteredGastos = this.filterData(this.data.gastos);
                
                const categoryData = {};
                filteredGastos.forEach(gasto => {
                    categoryData[gasto.categoria] = (categoryData[gasto.categoria] || 0) + gasto.valor;
                });
                
                const labels = Object.keys(categoryData);
                const data = Object.values(categoryData);
                
                if (this.charts.categoryChart) {
                    this.charts.categoryChart.destroy();
                }
                
                this.charts.categoryChart = new Chart(ctx, {
                    type: 'pie',
                    data: {
                        labels: labels,
                        datasets: [{
                            data: data,
                            backgroundColor: [
                                '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0',
                                '#9966FF', '#FF9F40', '#FF6384', '#C9CBCF'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            updateSavingsChart() {
                const ctx = document.getElementById('savingsChart').getContext('2d');
                const filteredPoupanca = this.filterData(this.data.poupanca);
                
                const sortedPoupanca = filteredPoupanca.sort((a, b) => new Date(a.data) - new Date(b.data));
                
                let saldo = 0;
                const labels = [];
                const data = [];
                
                sortedPoupanca.forEach(poupanca => {
                    saldo += poupanca.tipo === 'Depósito' ? poupanca.valor : -poupanca.valor;
                    labels.push(new Date(poupanca.data).toLocaleDateString());
                    data.push(saldo);
                });
                
                if (this.charts.savingsChart) {
                    this.charts.savingsChart.destroy();
                }
                
                this.charts.savingsChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Saldo da Poupança',
                            data: data,
                            borderColor: '#36A2EB',
                            backgroundColor: 'rgba(54, 162, 235, 0.1)',
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            renderAll() {
                this.renderRendas();
                this.renderGastos();
                this.renderGastosFixos();
                this.renderPoupanca();
                this.renderMetas();
                this.updateCharts();
            }

            exportData() {
                const dataToExport = {
                    exportDate: new Date().toISOString(),
                    data: this.data
                };
                
                const blob = new Blob([JSON.stringify(dataToExport, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `controle_financeiro_${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
            }
        }

        // Funções globais
        function showTab(tabName) {
            // Remove active class from all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });
            
            // Add active class to selected tab
            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');
        }

        function applyFilters() {
            financeManager.applyFilters();
        }

        function clearFilters() {
            financeManager.clearFilters();
        }

        function exportData() {
            financeManager.exportData();
        }

        // Inicializar sistema
        let financeManager;
        document.addEventListener('DOMContentLoaded', function() {
            financeManager = new FinanceManager();
            
            // Set today's date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('rendaData').value = today;
            document.getElementById('gastoData').value = today;
            document.getElementById('poupancaData').value = today;
        });
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDnxaYkEg4Y15mFFLEb8zOz4UqSME7UCZkM2y3I7B%2BAApPgxzHoBcf1PXbbh%2FCQ5iDHAuVZQK9zqSm21GWWwiVRJFxBu2TziFQQdQ%2FhKW5Gkd33w22V34bQOnZNI3KGDDXNFOBGBgv%2FpZQGQv0lfJ4sNyvFosXJMrrM8bQlbWjWwlGdn%2BK5wSAXG5cTKRnMn7ZBHWDgmlw7m06Ec0OfGVeSBHXmWTS68sd3LE3Iy6h%2FNjd9hIJjTMf8Hdiboii2Ym%2FUc6uHabwUx3yLliaXz4R06KR9lIuQ%2FpVTYXjgg%2FYEwijpNka2wiIhyi7gVFH6qMh0JWHDw0Q67RTAAVBPpQIEWUc1i3ONuut6kHdfIsquG0Hg1MOetJWWE0JKIsJdxJciPCg4CrMRO0%2FYfffgCV0JzNnh%2BowjJKbVibSKZudNTjB9%2Fhkh2Fi%2B%2B%2BaDBkxA0v2Xs%2FWTy3hnl7EPBFqnGOAqbG0r7fIhicazAr4tCvh8aQjaDhS%2BY5eZ7vg0nR8yuk7pKVkMtMA5Drez7xnd9tE9%2FTEjJLadDnEbNEPjTawYZF";
        window.__genspark_locale = "pt-BR";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDnxaYkEg4Y15mFFLEb8zOz4UqSME7UCZkM2y3I7B+AApPgxzHoBcf1PXbbh/CQ5iDHAuVZQK9zqSm21GWWwiVRJFxBu2TziFQQdQ/hKW5Gkd33w22V34bQOnZNI3KGDDXNFOBGBgv/pZQGQv0lfJ4sNyvFosXJMrrM8bQlbWjWwlGdn+K5wSAXG5cTKRnMn7ZBHWDgmlw7m06Ec0OfGVeSBHXmWTS68sd3LE3Iy6h/Njd9hIJjTMf8Hdiboii2Ym/Uc6uHabwUx3yLliaXz4R06KR9lIuQ/pVTYXjgg/YEwijpNka2wiIhyi7gVFH6qMh0JWHDw0Q67RTAAVBPpQIEWUc1i3ONuut6kHdfIsquG0Hg1MOetJWWE0JKIsJdxJciPCg4CrMRO0/YfffgCV0JzNnh+owjJKbVibSKZudNTjB9/hkh2Fi+++aDBkxA0v2Xs/WTy3hnl7EPBFqnGOAqbG0r7fIhicazAr4tCvh8aQjaDhS+Y5eZ7vg0nR8yuk7pKVkMtMA5Drez7xnd9tE9/TEjJLadDnEbNEPjTawYZF";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    