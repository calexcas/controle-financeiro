<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Controle Financeiro Familiar</title>
    <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=EKdcANg9AE07NXqUEzPqcCL_PrUg0KW_0uexUKY1MwzM046t67siZsWHIO5Qk1KcG4MbuoLzT0r7O3xVG05R8Pw0bfqoTgOwdnnfRaNNUup_J4D_VS24giIF7E40k7QAWwHvHKXWMnDqJvwJ7EokbjgVxXLw99yy6aT5SnqxVUutQCGmvdCmc5c0V7M-OB-e5CIojg4b813BzHx7sJAKbwQkDg5xh42sQ_72lPlI0e4m9F3oFoedr3P3EXAf-CVLdCpASX-kcp2vM1zIuddmrYnRjfSIFLE3GOY0rL-FLZKc8FMtbYEKbXIqWw3xwTClzL2KEEtPHI_D5Q75CNrfoSdOfZyJriH1smeTLaJfsXK4-cSjQla1l9BhnEFLOq0ETx3A0PQAzmn15MWE42tHYQ_rS9k6471SbBDP_FXePSsef4MMPILOpJF52FGCUPNof0mnvhNdcBYmIQXzoZCjsg" charset="UTF-8"></script><script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f7fa;
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px 0;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }

        .header p {
            margin-top: 10px;
            opacity: 0.9;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .tabs {
            display: flex;
            background: white;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .tab {
            flex: 1;
            padding: 15px 20px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: white;
            color: #666;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .tab:hover {
            background: #f8f9fa;
        }

        .tab.active {
            background: #667eea;
            color: white;
        }

        .tab-content {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .tab-content.active {
            display: block;
        }

        .filters {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .filters h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .filter-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            align-items: end;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: #28a745;
            color: white;
        }

        .btn-primary:hover {
            background: #218838;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #545b62;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
            padding: 8px 12px;
            font-size: 12px;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-edit {
            background: #007bff;
            color: white;
            padding: 8px 12px;
            font-size: 12px;
            margin-right: 5px;
        }

        .btn-edit:hover {
            background: #0056b3;
        }

        .btn-filter {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-filter:hover {
            transform: translateY(-2px);
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .card-renda {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .card-poupanca {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .card-gastos {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            color: white;
        }

        .card-saldo {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #333;
        }

        .card h3 {
            font-size: 14px;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .card .value {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .card-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            font-size: 24px;
            opacity: 0.3;
        }

        .charts {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .chart-container h3 {
            margin-bottom: 20px;
            color: #333;
            text-align: center;
        }

        .chart {
            width: 100%;
            height: 300px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table th,
        .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }

        .table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #333;
        }

        .table tr:hover {
            background: #f8f9fa;
        }

        .meta-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .meta-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .meta-title {
            font-size: 18px;
            font-weight: 600;
            color: #333;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e1e5e9;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #28a745 0%, #20c997 100%);
            transition: width 0.3s ease;
        }

        .meta-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .meta-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
        }

        .meta-btn-add {
            background: #28a745;
            color: white;
        }

        .meta-btn-sub {
            background: #ffc107;
            color: #333;
        }

        .meta-btn-del {
            background: #dc3545;
            color: white;
        }

        .parcelas-field {
            display: none;
            margin-top: 10px;
        }

        .parcelas-field.show {
            display: block;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .tabs {
                flex-direction: column;
            }

            .tab {
                padding: 12px;
            }

            .dashboard {
                grid-template-columns: 1fr;
            }

            .charts {
                grid-template-columns: 1fr;
            }

            .filter-row {
                grid-template-columns: 1fr;
            }
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: white;
            margin: 15% auto;
            padding: 30px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
        }

        .close {
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            color: #999;
        }

        .close:hover {
            color: #333;
        }

        .modal-actions {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üìä Sistema de Controle Financeiro Familiar</h1>
        <p>Gerencie suas finan√ßas de forma inteligente e visual</p>
    </div>

    <div class="container">
        <!-- Filtros -->
        <div class="filters">
            <h3>Filtros</h3>
            <div class="filter-row">
                <div class="form-group">
                    <label>Ano</label>
                    <select id="filtroAno">
                        <option value="">Todos</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>M√™s</label>
                    <select id="filtroMes">
                        <option value="">Todos</option>
                        <option value="01">Janeiro</option>
                        <option value="02">Fevereiro</option>
                        <option value="03">Mar√ßo</option>
                        <option value="04">Abril</option>
                        <option value="05">Maio</option>
                        <option value="06">Junho</option>
                        <option value="07">Julho</option>
                        <option value="08">Agosto</option>
                        <option value="09">Setembro</option>
                        <option value="10">Outubro</option>
                        <option value="11">Novembro</option>
                        <option value="12">Dezembro</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Categoria</label>
                    <select id="filtroCategoria">
                        <option value="">Todas</option>
                        <option value="Alimenta√ß√£o">Alimenta√ß√£o</option>
                        <option value="Transporte">Transporte</option>
                        <option value="Moradia">Moradia</option>
                        <option value="Lazer">Lazer</option>
                        <option value="Sa√∫de">Sa√∫de</option>
                        <option value="Educa√ß√£o">Educa√ß√£o</option>
                        <option value="Outros">Outros</option>
                    </select>
                </div>
                <div class="form-group">
                    <button class="btn btn-filter" onclick="aplicarFiltros()">
                        üîç Aplicar Filtros
                    </button>
                </div>
            </div>
        </div>

        <!-- Tabs -->
        <div class="tabs">
            <button class="tab active" onclick="showTab('dashboard')">üìä Dashboard</button>
            <button class="tab" onclick="showTab('gastos')">üõí Gastos</button>
            <button class="tab" onclick="showTab('gastos-fixos')">üè† Gastos Fixos</button>
            <button class="tab" onclick="showTab('rendas')">üí∞ Rendas</button>
            <button class="tab" onclick="showTab('poupanca')">üè¶ Poupan√ßa</button>
            <button class="tab" onclick="showTab('metas')">üéØ Metas</button>
        </div>

        <!-- Dashboard -->
        <div id="dashboard" class="tab-content active">
            <div class="dashboard">
                <div class="card card-renda">
                    <div class="card-icon">üí∞</div>
                    <h3>Renda Total</h3>
                    <div class="value" id="rendaTotal">R$ 0,00</div>
                </div>
                <div class="card card-poupanca">
                    <div class="card-icon">üè¶</div>
                    <h3>Total Poupado</h3>
                    <div class="value" id="totalPoupado">R$ 0,00</div>
                </div>
                <div class="card card-gastos">
                    <div class="card-icon">üõí</div>
                    <h3>Total Gastos</h3>
                    <div class="value" id="totalGastos">R$ 0,00</div>
                </div>
                <div class="card card-saldo">
                    <div class="card-icon">üí≥</div>
                    <h3>Saldo Atual</h3>
                    <div class="value" id="saldoAtual">R$ 0,00</div>
                </div>
            </div>

            <div class="charts">
                <div class="chart-container">
                    <h3>Gastos por Categoria</h3>
                    <div id="chartGastosPorCategoria" class="chart"></div>
                </div>
                <div class="chart-container">
                    <h3>Evolu√ß√£o da Poupan√ßa</h3>
                    <div id="chartEvolucaoPoupanca" class="chart"></div>
                </div>
            </div>

            <div class="chart-container">
                <h3>Gastos Fixos vs Vari√°veis</h3>
                <div id="chartGastosFixosVariaveis" class="chart"></div>
            </div>
        </div>

        <!-- Gastos -->
        <div id="gastos" class="tab-content">
            <h2>Controle de Gastos</h2>
            
            <div class="form-group">
                <h3>Adicionar Gasto</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <input type="date" id="gastoData" placeholder="Data">
                    <input type="text" id="gastoDescricao" placeholder="Descri√ß√£o">
                    <select id="gastoCategoria">
                        <option value="">Selecione</option>
                        <option value="Alimenta√ß√£o">Alimenta√ß√£o</option>
                        <option value="Transporte">Transporte</option>
                        <option value="Moradia">Moradia</option>
                        <option value="Lazer">Lazer</option>
                        <option value="Sa√∫de">Sa√∫de</option>
                        <option value="Educa√ß√£o">Educa√ß√£o</option>
                        <option value="Outros">Outros</option>
                    </select>
                    <input type="number" id="gastoValor" placeholder="Valor" step="0.01">
                    <select id="gastoFormaPagamento" onchange="toggleParcelas()">
                        <option value="">Forma de Pagamento</option>
                        <option value="Dinheiro">Dinheiro</option>
                        <option value="Cart√£o de Cr√©dito">Cart√£o de Cr√©dito</option>
                        <option value="Cart√£o de D√©bito">Cart√£o de D√©bito</option>
                        <option value="Transfer√™ncia">Transfer√™ncia</option>
                        <option value="Boleto">Boleto</option>
                    </select>
                </div>
                
                <div id="parcelasField" class="parcelas-field">
                    <div class="form-group">
                        <label>N√∫mero de Parcelas</label>
                        <select id="gastoParcelas">
                            <option value="1">√Ä vista</option>
                            <option value="2">2x</option>
                            <option value="3">3x</option>
                            <option value="4">4x</option>
                            <option value="5">5x</option>
                            <option value="6">6x</option>
                            <option value="7">7x</option>
                            <option value="8">8x</option>
                            <option value="9">9x</option>
                            <option value="10">10x</option>
                            <option value="11">11x</option>
                            <option value="12">12x</option>
                        </select>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="adicionarGasto()">
                    ‚ûï Adicionar Gasto
                </button>
            </div>

            <table class="table">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Descri√ß√£o</th>
                        <th>Categoria</th>
                        <th>Valor</th>
                        <th>Forma de Pagamento</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="listaGastos">
                </tbody>
            </table>
        </div>

        <!-- Gastos Fixos -->
        <div id="gastos-fixos" class="tab-content">
            <h2>Controle de Gastos Fixos</h2>
            
            <div class="form-group">
                <h3>Adicionar Gasto Fixo</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <input type="text" id="gastoFixoItem" placeholder="Item">
                    <input type="number" id="gastoFixoValor" placeholder="Valor Mensal" step="0.01">
                    <input type="date" id="gastoFixoInicio" placeholder="Data de In√≠cio">
                    <input type="date" id="gastoFixoFim" placeholder="Data de Fim">
                    <input type="text" id="gastoFixoObs" placeholder="Observa√ß√µes">
                </div>
                <button class="btn btn-primary" onclick="adicionarGastoFixo()">
                    ‚ûï Adicionar Gasto Fixo
                </button>
            </div>

            <table class="table">
                <thead>
                    <tr>
                        <th>Item</th>
                        <th>Valor Mensal</th>
                        <th>Data de In√≠cio</th>
                        <th>Data de Fim</th>
                        <th>Observa√ß√µes</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="listaGastosFixos">
                </tbody>
            </table>
        </div>

        <!-- Rendas -->
        <div id="rendas" class="tab-content">
            <h2>Controle de Rendas</h2>
            
            <div class="form-group">
                <h3>Adicionar Renda</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <select id="rendaMes">
                        <option value="">M√™s</option>
                        <option value="01">Janeiro</option>
                        <option value="02">Fevereiro</option>
                        <option value="03">Mar√ßo</option>
                        <option value="04">Abril</option>
                        <option value="05">Maio</option>
                        <option value="06">Junho</option>
                        <option value="07">Julho</option>
                        <option value="08">Agosto</option>
                        <option value="09">Setembro</option>
                        <option value="10">Outubro</option>
                        <option value="11">Novembro</option>
                        <option value="12">Dezembro</option>
                    </select>
                    <select id="rendaAno">
                        <option value="">Ano</option>
                    </select>
                    <select id="rendaTipo">
                        <option value="">Tipo de Renda</option>
                        <option value="Sal√°rio Titular">Sal√°rio Titular</option>
                        <option value="Sal√°rio C√¥njuge">Sal√°rio C√¥njuge</option>
                        <option value="Freelance">Freelance</option>
                        <option value="Investimentos">Investimentos</option>
                        <option value="Bonifica√ß√£o">Bonifica√ß√£o</option>
                        <option value="Outros">Outros</option>
                    </select>
                    <input type="number" id="rendaValor" placeholder="Valor" step="0.01">
                    <input type="text" id="rendaDescricao" placeholder="Descri√ß√£o">
                </div>
                <button class="btn btn-primary" onclick="adicionarRenda()">
                    ‚ûï Adicionar Renda
                </button>
            </div>

            <table class="table">
                <thead>
                    <tr>
                        <th>M√™s/Ano</th>
                        <th>Tipo</th>
                        <th>Valor</th>
                        <th>Descri√ß√£o</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="listaRendas">
                </tbody>
            </table>
        </div>

        <!-- Poupan√ßa -->
        <div id="poupanca" class="tab-content">
            <h2>Controle de Poupan√ßa</h2>
            
            <div class="form-group">
                <h3>Adicionar Movimenta√ß√£o</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <input type="date" id="poupancaData" placeholder="Data">
                    <select id="poupancaTipo">
                        <option value="">Tipo</option>
                        <option value="Dep√≥sito">Dep√≥sito</option>
                        <option value="Retirada">Retirada</option>
                    </select>
                    <input type="number" id="poupancaValor" placeholder="Valor" step="0.01">
                    <input type="text" id="poupancaDescricao" placeholder="Descri√ß√£o">
                </div>
                <button class="btn btn-primary" onclick="adicionarPoupanca()">
                    ‚ûï Adicionar Movimenta√ß√£o
                </button>
            </div>

            <table class="table">
                <thead>
                    <tr>
                        <th>Data</th>
                        <th>Tipo</th>
                        <th>Valor</th>
                        <th>Saldo</th>
                        <th>Descri√ß√£o</th>
                        <th>A√ß√µes</th>
                    </tr>
                </thead>
                <tbody id="listaPoupanca">
                </tbody>
            </table>
        </div>

        <!-- Metas -->
        <div id="metas" class="tab-content">
            <h2>Controle de Metas</h2>
            
            <div class="form-group">
                <h3>Adicionar Meta</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                    <input type="text" id="metaNome" placeholder="Nome da Meta">
                    <input type="number" id="metaValorAlvo" placeholder="Valor Alvo" step="0.01">
                    <input type="number" id="metaValorAtual" placeholder="Valor Atual" step="0.01">
                    <input type="date" id="metaDataLimite" placeholder="Data Limite">
                </div>
                <button class="btn btn-primary" onclick="adicionarMeta()">
                    ‚ûï Adicionar Meta
                </button>
            </div>

            <div id="listaMetas">
            </div>
        </div>
    </div>

    <!-- Modal de Edi√ß√£o -->
    <div id="editModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="editModalTitle">Editar Item</h3>
                <span class="close" onclick="closeEditModal()">&times;</span>
            </div>
            <div id="editModalBody">
                <!-- Conte√∫do din√¢mico -->
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeEditModal()">Cancelar</button>
                <button class="btn btn-primary" onclick="saveEdit()">Salvar</button>
            </div>
        </div>
    </div>

    <script>
        // Dados do aplicativo
        let dados = {
            gastos: [],
            gastosFixos: [],
            rendas: [],
            poupanca: [],
            metas: []
        };

        let editingItem = null;
        let editingType = null;

        // Inicializa√ß√£o
        document.addEventListener('DOMContentLoaded', function() {
            carregarDados();
            inicializarAnos();
            setDateToday();
            google.charts.load('current', {'packages':['corechart', 'line']});
            google.charts.setOnLoadCallback(atualizarDashboard);
        });

        function setDateToday() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('gastoData').value = today;
            document.getElementById('poupancaData').value = today;
        }

        function inicializarAnos() {
            const currentYear = new Date().getFullYear();
            const years = [];
            
            for (let i = currentYear; i <= currentYear + 10; i++) {
                years.push(i);
            }

            const selectElements = ['filtroAno', 'rendaAno'];
            selectElements.forEach(selectId => {
                const select = document.getElementById(selectId);
                years.forEach(year => {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    if (year === currentYear) option.selected = true;
                    select.appendChild(option);
                });
            });
        }

        function showTab(tabName) {
            // Ocultar todas as abas
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // Remover classe active de todas as tabs
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Mostrar aba selecionada
            document.getElementById(tabName).classList.add('active');
            
            // Adicionar classe active na tab clicada
            event.target.classList.add('active');

            if (tabName === 'dashboard') {
                atualizarDashboard();
            }
        }

        function toggleParcelas() {
            const formaPagamento = document.getElementById('gastoFormaPagamento').value;
            const parcelasField = document.getElementById('parcelasField');
            
            if (formaPagamento === 'Cart√£o de Cr√©dito') {
                parcelasField.classList.add('show');
            } else {
                parcelasField.classList.remove('show');
                document.getElementById('gastoParcelas').value = '1';
            }
        }

        function adicionarGasto() {
            const data = document.getElementById('gastoData').value;
            const descricao = document.getElementById('gastoDescricao').value;
            const categoria = document.getElementById('gastoCategoria').value;
            const valor = parseFloat(document.getElementById('gastoValor').value);
            const formaPagamento = document.getElementById('gastoFormaPagamento').value;
            const parcelas = parseInt(document.getElementById('gastoParcelas').value) || 1;

            if (!data || !descricao || !categoria || !valor || !formaPagamento) {
                alert('Preencha todos os campos!');
                return;
            }

            if (formaPagamento === 'Cart√£o de Cr√©dito' && parcelas > 1) {
                // Parcelamento autom√°tico
                const valorParcela = valor / parcelas;
                const dataBase = new Date(data);
                
                for (let i = 0; i < parcelas; i++) {
                    const dataParc = new Date(dataBase);
                    dataParc.setMonth(dataParc.getMonth() + i);
                    
                    const gasto = {
                        id: Date.now() + i,
                        data: dataParc.toISOString().split('T')[0],
                        descricao: `${descricao} (${i + 1}/${parcelas})`,
                        categoria,
                        valor: valorParcela,
                        formaPagamento,
                        isParcela: true,
                        parcelaAtual: i + 1,
                        totalParcelas: parcelas
                    };
                    dados.gastos.push(gasto);
                }
            } else {
                // Pagamento √† vista
                const gasto = {
                    id: Date.now(),
                    data,
                    descricao,
                    categoria,
                    valor,
                    formaPagamento,
                    isParcela: false
                };
                dados.gastos.push(gasto);
            }

            limparFormularioGasto();
            salvarDados();
            atualizarListaGastos();
            atualizarDashboard();
        }

        function adicionarGastoFixo() {
            const item = document.getElementById('gastoFixoItem').value;
            const valor = parseFloat(document.getElementById('gastoFixoValor').value);
            const inicio = document.getElementById('gastoFixoInicio').value;
            const fim = document.getElementById('gastoFixoFim').value;
            const observacoes = document.getElementById('gastoFixoObs').value;

            if (!item || !valor || !inicio) {
                alert('Preencha os campos obrigat√≥rios!');
                return;
            }

            const gastoFixo = {
                id: Date.now(),
                item,
                valor,
                inicio,
                fim,
                observacoes
            };

            dados.gastosFixos.push(gastoFixo);
            adicionarGastosFixosAGastos();
            limparFormularioGastoFixo();
            salvarDados();
            atualizarListaGastosFixos();
            atualizarDashboard();
        }

        function adicionarGastosFixosAGastos() {
            const hoje = new Date();
            
            dados.gastosFixos.forEach(gastoFixo => {
                const inicio = new Date(gastoFixo.inicio);
                const fim = gastoFixo.fim ? new Date(gastoFixo.fim) : new Date('2099-12-31');
                
                if (hoje >= inicio && hoje <= fim) {
                    // Verificar se j√° existe o gasto fixo no m√™s atual
                    const mesAtual = hoje.toISOString().substr(0, 7); // YYYY-MM
                    const jaExiste = dados.gastos.some(gasto => 
                        gasto.descricao === gastoFixo.item &&
                        gasto.data.substr(0, 7) === mesAtual &&
                        gasto.isGastoFixo
                    );

                    if (!jaExiste) {
                        const gastoFixoMensal = {
                            id: Date.now() + Math.random(),
                            data: hoje.toISOString().split('T')[0],
                            descricao: gastoFixo.item,
                            categoria: 'Gastos Fixos',
                            valor: gastoFixo.valor,
                            formaPagamento: 'Autom√°tico',
                            isGastoFixo: true
                        };
                        dados.gastos.push(gastoFixoMensal);
                    }
                }
            });
        }

        function adicionarRenda() {
            const mes = document.getElementById('rendaMes').value;
            const ano = document.getElementById('rendaAno').value;
            const tipo = document.getElementById('rendaTipo').value;
            const valor = parseFloat(document.getElementById('rendaValor').value);
            const descricao = document.getElementById('rendaDescricao').value;

            if (!mes || !ano || !tipo || !valor) {
                alert('Preencha todos os campos obrigat√≥rios!');
                return;
            }

            const renda = {
                id: Date.now(),
                mes,
                ano,
                tipo,
                valor,
                descricao
            };

            dados.rendas.push(renda);
            limparFormularioRenda();
            salvarDados();
            atualizarListaRendas();
            atualizarDashboard();
        }

        function adicionarPoupanca() {
            const data = document.getElementById('poupancaData').value;
            const tipo = document.getElementById('poupancaTipo').value;
            const valor = parseFloat(document.getElementById('poupancaValor').value);
            const descricao = document.getElementById('poupancaDescricao').value;

            if (!data || !tipo || !valor) {
                alert('Preencha todos os campos obrigat√≥rios!');
                return;
            }

            const poupanca = {
                id: Date.now(),
                data,
                tipo,
                valor,
                descricao
            };

            dados.poupanca.push(poupanca);
            calcularSaldoPoupanca();
            limparFormularioPoupanca();
            salvarDados();
            atualizarListaPoupanca();
            atualizarDashboard();
        }

        function calcularSaldoPoupanca() {
            dados.poupanca.sort((a, b) => new Date(a.data) - new Date(b.data));
            let saldo = 0;
            
            dados.poupanca.forEach(item => {
                if (item.tipo === 'Dep√≥sito') {
                    saldo += item.valor;
                } else {
                    saldo -= item.valor;
                }
                item.saldo = saldo;
            });
        }

        function adicionarMeta() {
            const nome = document.getElementById('metaNome').value;
            const valorAlvo = parseFloat(document.getElementById('metaValorAlvo').value);
            const valorAtual = parseFloat(document.getElementById('metaValorAtual').value) || 0;
            const dataLimite = document.getElementById('metaDataLimite').value;

            if (!nome || !valorAlvo || !dataLimite) {
                alert('Preencha todos os campos obrigat√≥rios!');
                return;
            }

            const meta = {
                id: Date.now(),
                nome,
                valorAlvo,
                valorAtual,
                dataLimite
            };

            dados.metas.push(meta);
            limparFormularioMeta();
            salvarDados();
            atualizarListaMetas();
        }

        function editarItem(type, id) {
            editingType = type;
            
            let item;
            switch(type) {
                case 'gasto':
                    item = dados.gastos.find(g => g.id === id);
                    break;
                case 'gastoFixo':
                    item = dados.gastosFixos.find(g => g.id === id);
                    break;
                case 'renda':
                    item = dados.rendas.find(r => r.id === id);
                    break;
                case 'poupanca':
                    item = dados.poupanca.find(p => p.id === id);
                    break;
                case 'meta':
                    item = dados.metas.find(m => m.id === id);
                    break;
            }

            if (!item) return;
            
            editingItem = item;
            showEditModal(type, item);
        }

        function showEditModal(type, item) {
            const modal = document.getElementById('editModal');
            const title = document.getElementById('editModalTitle');
            const body = document.getElementById('editModalBody');

            title.textContent = `Editar ${type.charAt(0).toUpperCase() + type.slice(1)}`;

            let html = '';
            switch(type) {
                case 'gasto':
                    html = `
                        <div class="form-group">
                            <label>Data</label>
                            <input type="date" id="editData" value="${item.data}">
                        </div>
                        <div class="form-group">
                            <label>Descri√ß√£o</label>
                            <input type="text" id="editDescricao" value="${item.descricao}">
                        </div>
                        <div class="form-group">
                            <label>Categoria</label>
                            <select id="editCategoria">
                                <option value="Alimenta√ß√£o" ${item.categoria === 'Alimenta√ß√£o' ? 'selected' : ''}>Alimenta√ß√£o</option>
                                <option value="Transporte" ${item.categoria === 'Transporte' ? 'selected' : ''}>Transporte</option>
                                <option value="Moradia" ${item.categoria === 'Moradia' ? 'selected' : ''}>Moradia</option>
                                <option value="Lazer" ${item.categoria === 'Lazer' ? 'selected' : ''}>Lazer</option>
                                <option value="Sa√∫de" ${item.categoria === 'Sa√∫de' ? 'selected' : ''}>Sa√∫de</option>
                                <option value="Educa√ß√£o" ${item.categoria === 'Educa√ß√£o' ? 'selected' : ''}>Educa√ß√£o</option>
                                <option value="Outros" ${item.categoria === 'Outros' ? 'selected' : ''}>Outros</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Valor</label>
                            <input type="number" id="editValor" value="${item.valor}" step="0.01">
                        </div>
                    `;
                    break;
                case 'gastoFixo':
                    html = `
                        <div class="form-group">
                            <label>Item</label>
                            <input type="text" id="editItem" value="${item.item}">
                        </div>
                        <div class="form-group">
                            <label>Valor Mensal</label>
                            <input type="number" id="editValor" value="${item.valor}" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Data de In√≠cio</label>
                            <input type="date" id="editInicio" value="${item.inicio}">
                        </div>
                        <div class="form-group">
                            <label>Data de Fim</label>
                            <input type="date" id="editFim" value="${item.fim || ''}">
                        </div>
                        <div class="form-group">
                            <label>Observa√ß√µes</label>
                            <input type="text" id="editObservacoes" value="${item.observacoes || ''}">
                        </div>
                    `;
                    break;
                case 'renda':
                    html = `
                        <div class="form-group">
                            <label>M√™s</label>
                            <select id="editMes">
                                <option value="01" ${item.mes === '01' ? 'selected' : ''}>Janeiro</option>
                                <option value="02" ${item.mes === '02' ? 'selected' : ''}>Fevereiro</option>
                                <option value="03" ${item.mes === '03' ? 'selected' : ''}>Mar√ßo</option>
                                <option value="04" ${item.mes === '04' ? 'selected' : ''}>Abril</option>
                                <option value="05" ${item.mes === '05' ? 'selected' : ''}>Maio</option>
                                <option value="06" ${item.mes === '06' ? 'selected' : ''}>Junho</option>
                                <option value="07" ${item.mes === '07' ? 'selected' : ''}>Julho</option>
                                <option value="08" ${item.mes === '08' ? 'selected' : ''}>Agosto</option>
                                <option value="09" ${item.mes === '09' ? 'selected' : ''}>Setembro</option>
                                <option value="10" ${item.mes === '10' ? 'selected' : ''}>Outubro</option>
                                <option value="11" ${item.mes === '11' ? 'selected' : ''}>Novembro</option>
                                <option value="12" ${item.mes === '12' ? 'selected' : ''}>Dezembro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Ano</label>
                            <input type="number" id="editAno" value="${item.ano}">
                        </div>
                        <div class="form-group">
                            <label>Tipo</label>
                            <select id="editTipo">
                                <option value="Sal√°rio Titular" ${item.tipo === 'Sal√°rio Titular' ? 'selected' : ''}>Sal√°rio Titular</option>
                                <option value="Sal√°rio C√¥njuge" ${item.tipo === 'Sal√°rio C√¥njuge' ? 'selected' : ''}>Sal√°rio C√¥njuge</option>
                                <option value="Freelance" ${item.tipo === 'Freelance' ? 'selected' : ''}>Freelance</option>
                                <option value="Investimentos" ${item.tipo === 'Investimentos' ? 'selected' : ''}>Investimentos</option>
                                <option value="Bonifica√ß√£o" ${item.tipo === 'Bonifica√ß√£o' ? 'selected' : ''}>Bonifica√ß√£o</option>
                                <option value="Outros" ${item.tipo === 'Outros' ? 'selected' : ''}>Outros</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Valor</label>
                            <input type="number" id="editValor" value="${item.valor}" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Descri√ß√£o</label>
                            <input type="text" id="editDescricao" value="${item.descricao || ''}">
                        </div>
                    `;
                    break;
                case 'poupanca':
                    html = `
                        <div class="form-group">
                            <label>Data</label>
                            <input type="date" id="editData" value="${item.data}">
                        </div>
                        <div class="form-group">
                            <label>Tipo</label>
                            <select id="editTipo">
                                <option value="Dep√≥sito" ${item.tipo === 'Dep√≥sito' ? 'selected' : ''}>Dep√≥sito</option>
                                <option value="Retirada" ${item.tipo === 'Retirada' ? 'selected' : ''}>Retirada</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Valor</label>
                            <input type="number" id="editValor" value="${item.valor}" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Descri√ß√£o</label>
                            <input type="text" id="editDescricao" value="${item.descricao || ''}">
                        </div>
                    `;
                    break;
                case 'meta':
                    html = `
                        <div class="form-group">
                            <label>Nome</label>
                            <input type="text" id="editNome" value="${item.nome}">
                        </div>
                        <div class="form-group">
                            <label>Valor Alvo</label>
                            <input type="number" id="editValorAlvo" value="${item.valorAlvo}" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Valor Atual</label>
                            <input type="number" id="editValorAtual" value="${item.valorAtual}" step="0.01">
                        </div>
                        <div class="form-group">
                            <label>Data Limite</label>
                            <input type="date" id="editDataLimite" value="${item.dataLimite}">
                        </div>
                    `;
                    break;
            }

            body.innerHTML = html;
            modal.style.display = 'block';
        }

        function closeEditModal() {
            document.getElementById('editModal').style.display = 'none';
            editingItem = null;
            editingType = null;
        }

        function saveEdit() {
            if (!editingItem || !editingType) return;

            switch(editingType) {
                case 'gasto':
                    editingItem.data = document.getElementById('editData').value;
                    editingItem.descricao = document.getElementById('editDescricao').value;
                    editingItem.categoria = document.getElementById('editCategoria').value;
                    editingItem.valor = parseFloat(document.getElementById('editValor').value);
                    atualizarListaGastos();
                    break;
                case 'gastoFixo':
                    editingItem.item = document.getElementById('editItem').value;
                    editingItem.valor = parseFloat(document.getElementById('editValor').value);
                    editingItem.inicio = document.getElementById('editInicio').value;
                    editingItem.fim = document.getElementById('editFim').value;
                    editingItem.observacoes = document.getElementById('editObservacoes').value;
                    atualizarListaGastosFixos();
                    break;
                case 'renda':
                    editingItem.mes = document.getElementById('editMes').value;
                    editingItem.ano = document.getElementById('editAno').value;
                    editingItem.tipo = document.getElementById('editTipo').value;
                    editingItem.valor = parseFloat(document.getElementById('editValor').value);
                    editingItem.descricao = document.getElementById('editDescricao').value;
                    atualizarListaRendas();
                    break;
                case 'poupanca':
                    editingItem.data = document.getElementById('editData').value;
                    editingItem.tipo = document.getElementById('editTipo').value;
                    editingItem.valor = parseFloat(document.getElementById('editValor').value);
                    editingItem.descricao = document.getElementById('editDescricao').value;
                    calcularSaldoPoupanca();
                    atualizarListaPoupanca();
                    break;
                case 'meta':
                    editingItem.nome = document.getElementById('editNome').value;
                    editingItem.valorAlvo = parseFloat(document.getElementById('editValorAlvo').value);
                    editingItem.valorAtual = parseFloat(document.getElementById('editValorAtual').value);
                    editingItem.dataLimite = document.getElementById('editDataLimite').value;
                    atualizarListaMetas();
                    break;
            }

            salvarDados();
            atualizarDashboard();
            closeEditModal();
        }

        function excluirItem(type, id) {
            if (!confirm('Tem certeza que deseja excluir este item?')) return;

            switch(type) {
                case 'gasto':
                    dados.gastos = dados.gastos.filter(g => g.id !== id);
                    atualizarListaGastos();
                    break;
                case 'gastoFixo':
                    dados.gastosFixos = dados.gastosFixos.filter(g => g.id !== id);
                    atualizarListaGastosFixos();
                    break;
                case 'renda':
                    dados.rendas = dados.rendas.filter(r => r.id !== id);
                    atualizarListaRendas();
                    break;
                case 'poupanca':
                    dados.poupanca = dados.poupanca.filter(p => p.id !== id);
                    calcularSaldoPoupanca();
                    atualizarListaPoupanca();
                    break;
                case 'meta':
                    dados.metas = dados.metas.filter(m => m.id !== id);
                    atualizarListaMetas();
                    break;
            }

            salvarDados();
            atualizarDashboard();
        }

        function atualizarValorMeta(id, valor) {
            const meta = dados.metas.find(m => m.id === id);
            if (meta) {
                meta.valorAtual += valor;
                if (meta.valorAtual < 0) meta.valorAtual = 0;
                salvarDados();
                atualizarListaMetas();
            }
        }

        function aplicarFiltros() {
            atualizarDashboard();
            atualizarListaGastos();
        }

        function obterDadosFiltrados() {
            const filtroAno = document.getElementById('filtroAno').value;
            const filtroMes = document.getElementById('filtroMes').value;
            const filtroCategoria = document.getElementById('filtroCategoria').value;

            let gastosFiltrados = dados.gastos.filter(gasto => {
                const [ano, mes] = gasto.data.split('-');
                
                if (filtroAno && ano !== filtroAno) return false;
                if (filtroMes && mes !== filtroMes) return false;
                if (filtroCategoria && gasto.categoria !== filtroCategoria) return false;
                
                return true;
            });

            let rendasFiltradas = dados.rendas.filter(renda => {
                if (filtroAno && renda.ano !== filtroAno) return false;
                if (filtroMes && renda.mes !== filtroMes) return false;
                
                return true;
            });

            let poupancaFiltrada = dados.poupanca.filter(poup => {
                const [ano, mes] = poup.data.split('-');
                
                if (filtroAno && ano !== filtroAno) return false;
                if (filtroMes && mes !== filtroMes) return false;
                
                return true;
            });

            return {
                gastos: gastosFiltrados,
                rendas: rendasFiltradas,
                poupanca: poupancaFiltrada
            };
        }

        function atualizarDashboard() {
            const dadosFiltrados = obterDadosFiltrados();
            
            // Calcular totais
            const totalRendas = dadosFiltrados.rendas.reduce((sum, renda) => sum + renda.valor, 0);
            const totalGastos = dadosFiltrados.gastos.reduce((sum, gasto) => sum + gasto.valor, 0);
            
            let totalPoupado = 0;
            dadosFiltrados.poupanca.forEach(item => {
                if (item.tipo === 'Dep√≥sito') {
                    totalPoupado += item.valor;
                } else {
                    totalPoupado -= item.valor;
                }
            });

            const saldoAtual = totalRendas - totalPoupado - totalGastos;

            // Atualizar cards
            document.getElementById('rendaTotal').textContent = formatarMoeda(totalRendas);
            document.getElementById('totalPoupado').textContent = formatarMoeda(totalPoupado);
            document.getElementById('totalGastos').textContent = formatarMoeda(totalGastos);
            document.getElementById('saldoAtual').textContent = formatarMoeda(saldoAtual);

            // Atualizar gr√°ficos
            atualizarGraficos(dadosFiltrados);
        }

        function atualizarGraficos(dadosFiltrados) {
            // Gr√°fico de Gastos por Categoria
            const gastosPorCategoria = {};
            dadosFiltrados.gastos.forEach(gasto => {
                gastosPorCategoria[gasto.categoria] = (gastosPorCategoria[gasto.categoria] || 0) + gasto.valor;
            });

            const dataCategoria = [['Categoria', 'Valor']];
            Object.entries(gastosPorCategoria).forEach(([categoria, valor]) => {
                dataCategoria.push([categoria, valor]);
            });

            if (dataCategoria.length > 1) {
                const chartCategoria = new google.visualization.PieChart(document.getElementById('chartGastosPorCategoria'));
                chartCategoria.draw(google.visualization.arrayToDataTable(dataCategoria), {
                    title: 'Distribui√ß√£o de Gastos',
                    pieHole: 0.4,
                    colors: ['#667eea', '#764ba2', '#f093fb', '#f5576c', '#4facfe', '#00f2fe']
                });
            }

            // Gr√°fico de Evolu√ß√£o da Poupan√ßa
            const dadosPoupanca = [['Data', 'Saldo']];
            let saldoAcum = 0;
            
            dadosFiltrados.poupanca.sort((a, b) => new Date(a.data) - new Date(b.data));
            dadosFiltrados.poupanca.forEach(item => {
                if (item.tipo === 'Dep√≥sito') {
                    saldoAcum += item.valor;
                } else {
                    saldoAcum -= item.valor;
                }
                dadosPoupanca.push([new Date(item.data), saldoAcum]);
            });

            if (dadosPoupanca.length > 1) {
                const chartPoupanca = new google.visualization.LineChart(document.getElementById('chartEvolucaoPoupanca'));
                chartPoupanca.draw(google.visualization.arrayToDataTable(dadosPoupanca), {
                    title: 'Evolu√ß√£o do Saldo da Poupan√ßa',
                    curveType: 'function',
                    legend: { position: 'bottom' },
                    colors: ['#4facfe']
                });
            }

            // Gr√°fico de Gastos Fixos vs Vari√°veis
            const gastosFixosVariaveis = [['M√™s', 'Gastos Fixos', 'Gastos Vari√°veis']];
            const meses = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
            
            for (let i = 1; i <= 12; i++) {
                const mes = i.toString().padStart(2, '0');
                const gastosFixos = dadosFiltrados.gastos.filter(g => g.data.includes(`-${mes}-`) && g.isGastoFixo).reduce((sum, g) => sum + g.valor, 0);
                const gastosVariaveis = dadosFiltrados.gastos.filter(g => g.data.includes(`-${mes}-`) && !g.isGastoFixo).reduce((sum, g) => sum + g.valor, 0);
                
                if (gastosFixos > 0 || gastosVariaveis > 0) {
                    gastosFixosVariaveis.push([meses[i-1], gastosFixos, gastosVariaveis]);
                }
            }

            if (gastosFixosVariaveis.length > 1) {
                const chartFixosVariaveis = new google.visualization.ColumnChart(document.getElementById('chartGastosFixosVariaveis'));
                chartFixosVariaveis.draw(google.visualization.arrayToDataTable(gastosFixosVariaveis), {
                    title: 'Gastos Fixos vs Vari√°veis por M√™s',
                    colors: ['#667eea', '#f093fb'],
                    legend: { position: 'top', maxLines: 3 }
                });
            }
        }

        function atualizarListaGastos() {
            const dadosFiltrados = obterDadosFiltrados();
            const tbody = document.getElementById('listaGastos');
            tbody.innerHTML = '';

            dadosFiltrados.gastos.sort((a, b) => new Date(b.data) - new Date(a.data));
            
            dadosFiltrados.gastos.forEach(gasto => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${formatarData(gasto.data)}</td>
                    <td>${gasto.descricao}</td>
                    <td>${gasto.categoria}</td>
                    <td>${formatarMoeda(gasto.valor)}</td>
                    <td>${gasto.formaPagamento}</td>
                    <td>
                        <button class="btn btn-edit" onclick="editarItem('gasto', ${gasto.id})">‚úèÔ∏è</button>
                        <button class="btn btn-danger" onclick="excluirItem('gasto', ${gasto.id})">‚ùå</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function atualizarListaGastosFixos() {
            const tbody = document.getElementById('listaGastosFixos');
            tbody.innerHTML = '';

            dados.gastosFixos.forEach(gasto => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${gasto.item}</td>
                    <td>${formatarMoeda(gasto.valor)}</td>
                    <td>${formatarData(gasto.inicio)}</td>
                    <td>${gasto.fim ? formatarData(gasto.fim) : '-'}</td>
                    <td>${gasto.observacoes || '-'}</td>
                    <td>
                        <button class="btn btn-edit" onclick="editarItem('gastoFixo', ${gasto.id})">‚úèÔ∏è</button>
                        <button class="btn btn-danger" onclick="excluirItem('gastoFixo', ${gasto.id})">‚ùå</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function atualizarListaRendas() {
            const tbody = document.getElementById('listaRendas');
            tbody.innerHTML = '';

            dados.rendas.sort((a, b) => {
                if (a.ano !== b.ano) return b.ano - a.ano;
                return b.mes.localeCompare(a.mes);
            });

            dados.rendas.forEach(renda => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${renda.mes}/${renda.ano}</td>
                    <td>${renda.tipo}</td>
                    <td>${formatarMoeda(renda.valor)}</td>
                    <td>${renda.descricao || '-'}</td>
                    <td>
                        <button class="btn btn-edit" onclick="editarItem('renda', ${renda.id})">‚úèÔ∏è</button>
                        <button class="btn btn-danger" onclick="excluirItem('renda', ${renda.id})">‚ùå</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function atualizarListaPoupanca() {
            const tbody = document.getElementById('listaPoupanca');
            tbody.innerHTML = '';

            dados.poupanca.sort((a, b) => new Date(b.data) - new Date(a.data));

            dados.poupanca.forEach(poup => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${formatarData(poup.data)}</td>
                    <td>${poup.tipo}</td>
                    <td>${formatarMoeda(poup.valor)}</td>
                    <td>${formatarMoeda(poup.saldo || 0)}</td>
                    <td>${poup.descricao || '-'}</td>
                    <td>
                        <button class="btn btn-edit" onclick="editarItem('poupanca', ${poup.id})">‚úèÔ∏è</button>
                        <button class="btn btn-danger" onclick="excluirItem('poupanca', ${poup.id})">‚ùå</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function atualizarListaMetas() {
            const container = document.getElementById('listaMetas');
            container.innerHTML = '';

            dados.metas.forEach(meta => {
                const progresso = (meta.valorAtual / meta.valorAlvo) * 100;
                const status = progresso >= 100 ? 'Conclu√≠da' : 'Em Progresso';
                
                const div = document.createElement('div');
                div.className = 'meta-card';
                div.innerHTML = `
                    <div class="meta-header">
                        <div class="meta-title">${meta.nome}</div>
                        <span style="color: ${status === 'Conclu√≠da' ? '#28a745' : '#ffc107'}">${status}</span>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 10px;">
                        <div><strong>Valor Alvo:</strong> ${formatarMoeda(meta.valorAlvo)}</div>
                        <div><strong>Valor Atual:</strong> ${formatarMoeda(meta.valorAtual)}</div>
                        <div><strong>Data Limite:</strong> ${formatarData(meta.dataLimite)}</div>
                        <div><strong>Progresso:</strong> ${progresso.toFixed(1)}%</div>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${Math.min(progresso, 100)}%"></div>
                    </div>
                    <div class="meta-actions">
                        <button class="meta-btn meta-btn-add" onclick="atualizarValorMeta(${meta.id}, 100)">+100</button>
                        <button class="meta-btn meta-btn-add" onclick="atualizarValorMeta(${meta.id}, 500)">+500</button>
                        <button class="meta-btn meta-btn-sub" onclick="atualizarValorMeta(${meta.id}, -100)">-100</button>
                        <button class="btn btn-edit" onclick="editarItem('meta', ${meta.id})">‚úèÔ∏è</button>
                        <button class="meta-btn meta-btn-del" onclick="excluirItem('meta', ${meta.id})">‚ùå</button>
                    </div>
                `;
                container.appendChild(div);
            });
        }

        function limparFormularioGasto() {
            document.getElementById('gastoDescricao').value = '';
            document.getElementById('gastoCategoria').value = '';
            document.getElementById('gastoValor').value = '';
            document.getElementById('gastoFormaPagamento').value = '';
            document.getElementById('gastoParcelas').value = '1';
            document.getElementById('parcelasField').classList.remove('show');
        }

        function limparFormularioGastoFixo() {
            document.getElementById('gastoFixoItem').value = '';
            document.getElementById('gastoFixoValor').value = '';
            document.getElementById('gastoFixoInicio').value = '';
            document.getElementById('gastoFixoFim').value = '';
            document.getElementById('gastoFixoObs').value = '';
        }

        function limparFormularioRenda() {
            document.getElementById('rendaMes').value = '';
            document.getElementById('rendaTipo').value = '';
            document.getElementById('rendaValor').value = '';
            document.getElementById('rendaDescricao').value = '';
        }

        function limparFormularioPoupanca() {
            document.getElementById('poupancaTipo').value = '';
            document.getElementById('poupancaValor').value = '';
            document.getElementById('poupancaDescricao').value = '';
            setDateToday();
        }

        function limparFormularioMeta() {
            document.getElementById('metaNome').value = '';
            document.getElementById('metaValorAlvo').value = '';
            document.getElementById('metaValorAtual').value = '';
            document.getElementById('metaDataLimite').value = '';
        }

        function formatarMoeda(valor) {
            return new Intl.NumberFormat('pt-BR', {
                style: 'currency',
                currency: 'BRL'
            }).format(valor);
        }

        function formatarData(data) {
            const [ano, mes, dia] = data.split('-');
            return `${dia}/${mes}/${ano}`;
        }

        function salvarDados() {
            localStorage.setItem('dadosFinanceiros', JSON.stringify(dados));
        }

        function carregarDados() {
            const dadosSalvos = localStorage.getItem('dadosFinanceiros');
            if (dadosSalvos) {
                dados = JSON.parse(dadosSalvos);
                calcularSaldoPoupanca();
                adicionarGastosFixosAGastos();
                atualizarListaGastos();
                atualizarListaGastosFixos();
                atualizarListaRendas();
                atualizarListaPoupanca();
                atualizarListaMetas();
            }
        }

        // Fechar modal ao clicar fora
        window.onclick = function(event) {
            const modal = document.getElementById('editModal');
            if (event.target == modal) {
                closeEditModal();
            }
        }
    </script>
</body>
</html>
    <script id="html_badge_script1">
        window.__genspark_remove_badge_link = "https://www.genspark.ai/api/html_badge/" +
            "remove_badge?token=To%2FBnjzloZ3UfQdcSaYfDrGI4ofLGRIe6aZ5f0YMfA9qIqbsYMxzIeF8%2BDN%2BIAUpMoF3%2B8nJ6tB9TAGAUpBhA7BfPrl3cdzHYYqeRDVaXMDuuv0mb0t%2FBC9nCR6SxXwn5rKyTlVeN4FL%2FI43oGK7HX1QoSmKwcxWd%2BCd4khLldsmOnuJcffQLhtaF3TlNUmCxvTuF81dEVX3jC6mOq4KHg%2BFZiXLRkFzAJBPFQr8OGmI%2FAbNgctRp7CPAeDsugubr3e5wdhLR9%2B0mpDvHjFIbgs7uT0ygysXuptEt%2BDBVK1V7jKQsQFqNeqd%2FOHvRQw4GKz3X6p6ZvsPYRZyt8hs%2BVc2pzzIdNNG1DSE%2FNilMtl5pfGt65mPG2MgQwSOw861%2BU0UZshNVRWV%2Bq2lMEs5%2BzeAENInde2J8rzViYZ0VyEFNpM3XIDzDUMVky%2B9bzVyhyqZo9SaKrX0TA86GYHNoOzbHcOQiWWDmM9Y5wEdy739PqlcOL44JAbLB82EThiz30%2FUdxbx3a2Ryv7kWuKfuzb3zFueZaNzLEOfUE9LDYc%3D";
        window.__genspark_locale = "pt-BR";
        window.__genspark_token = "To/BnjzloZ3UfQdcSaYfDrGI4ofLGRIe6aZ5f0YMfA9qIqbsYMxzIeF8+DN+IAUpMoF3+8nJ6tB9TAGAUpBhA7BfPrl3cdzHYYqeRDVaXMDuuv0mb0t/BC9nCR6SxXwn5rKyTlVeN4FL/I43oGK7HX1QoSmKwcxWd+Cd4khLldsmOnuJcffQLhtaF3TlNUmCxvTuF81dEVX3jC6mOq4KHg+FZiXLRkFzAJBPFQr8OGmI/AbNgctRp7CPAeDsugubr3e5wdhLR9+0mpDvHjFIbgs7uT0ygysXuptEt+DBVK1V7jKQsQFqNeqd/OHvRQw4GKz3X6p6ZvsPYRZyt8hs+Vc2pzzIdNNG1DSE/NilMtl5pfGt65mPG2MgQwSOw861+U0UZshNVRWV+q2lMEs5+zeAENInde2J8rzViYZ0VyEFNpM3XIDzDUMVky+9bzVyhyqZo9SaKrX0TA86GYHNoOzbHcOQiWWDmM9Y5wEdy739PqlcOL44JAbLB82EThiz30/Udxbx3a2Ryv7kWuKfuzb3zFueZaNzLEOfUE9LDYc=";
    </script>
    
    <script id="html_notice_dialog_script" src="https://www.genspark.ai/notice_dialog.js"></script>
    